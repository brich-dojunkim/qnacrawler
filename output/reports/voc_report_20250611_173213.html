<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>카테고리 기반 VoC 분석 보고서</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
/* === 기본 리셋 === */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* === 전역 기본 스타일 === */
body {
    font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    color: #333;
    line-height: 1.6;
    padding: 20px;
}

/* === 메인 컨테이너 === */
.container {
    max-width: 1400px;
    margin: 0 auto;
    background: white;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
    overflow: hidden;
}

/* === 헤더 === */
.header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 40px 30px;
    text-align: center;
    position: relative;
}

.header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 15px;
    text-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.header p {
    font-size: 1.1rem;
    margin-bottom: 10px;
    opacity: 0.95;
}

.header .analysis-date {
    font-size: 1rem;
    margin-top: 15px;
    padding: 8px 16px;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 20px;
    display: inline-block;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

/* === 메인 콘텐츠 === */
.main-content {
    padding: 40px 30px;
}

/* === 푸터 === */
.footer {
    text-align: center;
    padding: 30px;
    background: linear-gradient(135deg, #f8fafc, #e2e8f0);
    border-top: 1px solid #e2e8f0;
    color: #64748b;
    font-size: 0.9rem;
    font-weight: 500;
}


/* === 그리드 시스템 === */
.grid {
    display: grid;
    gap: 24px;
}

.grid-2 { grid-template-columns: repeat(2, 1fr); }
.grid-3 { grid-template-columns: repeat(3, 1fr); }
.grid-4 { grid-template-columns: repeat(4, 1fr); }
.grid-5 { grid-template-columns: repeat(5, 1fr); }

/* === 팀별 탭 특별 레이아웃 === */
.teams-layout {
    display: flex;
    flex-wrap: wrap;
    gap: 24px;
}

.teams-layout .entity-card {
    /* 상위 3개(1~3) */
    flex: 1 1 calc(33.333% - 24px);
}

.teams-layout .entity-card:nth-child(n+4) {
    /* 하위 4개(4~7) */
    flex: 1 1 calc(25% - 24px);
}

/* === 심플 리스트 레이아웃 === */
.simple-list {
    margin: 16px 0;
}

.simple-list-title {
    font-size: 0.9rem;
    font-weight: 700;
    margin-bottom: 12px;
    color: #374151;
}

.simple-item {
    display: flex;
    align-items: center;
    margin-bottom: 6px;
    padding: 8px 12px;
    background: #f8fafc;
    border-radius: 8px;
    font-size: 0.85rem;
    transition: background 0.2s ease;
}

.simple-item:hover {
    background: #e0f2fe;
}

.simple-rank {
    min-width: 24px;
    font-weight: 700;
    color: #667eea;
}

.simple-name {
    flex: 1;
    margin-left: 8px;
    color: #374151;
    font-weight: 500;
}

.simple-value {
    min-width: 60px;
    text-align: right;
    font-weight: 700;
    color: #667eea;
}


/* === 반응형 디자인 === */

/* 1200px 이하 - 태블릿 */
@media (max-width: 1200px) {
    .main-stats-grid {
        grid-template-columns: 1fr 1fr;
        gap: 16px;
    }
    
    .stat-card-large {
        grid-column: 1 / -1;
        padding: 24px;
    }
    
    .stat-number-large {
        font-size: 2.5rem;
    }
    
    .distribution-grid {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .teams-layout .entity-card,
    .teams-layout .entity-card:nth-child(n+4) {
        flex: 1 1 calc(50% - 24px);
    }
}

/* 768px 이하 - 모바일 */
@media (max-width: 768px) {
    body {
        padding: 10px;
    }
    
    .container {
        border-radius: 16px;
    }
    
    .header {
        padding: 30px 20px;
    }
    
    .header h1 {
        font-size: 2rem;
    }
    
    .main-content {
        padding: 20px;
    }
    
    .tab-content {
        padding: 20px;
    }
    
    .main-stats-grid {
        grid-template-columns: 1fr;
        gap: 12px;
    }
    
    .stat-card-large {
        flex-direction: column;
        text-align: center;
        padding: 20px;
    }
    
    .stat-number-large {
        font-size: 2rem;
    }
    
    .stat-number-medium {
        font-size: 1.5rem;
    }
    
    .simple-rank-item {
        flex-direction: column;
        gap: 12px;
        text-align: center;
        padding: 20px;
    }
    
    .simple-rank-number {
        margin-right: 0;
        margin-bottom: 8px;
    }
    
    .simple-rank-content {
        flex-direction: column;
        gap: 8px;
        width: 100%;
    }
    
    .grid-2, .grid-3, .grid-4, .grid-5 { 
        grid-template-columns: 1fr; 
    }
    
    .teams-layout .entity-card {
        flex: 1 1 100%;
    }
    
    .filter-buttons {
        flex-wrap: wrap;
        justify-content: center;
        gap: 8px;
    }
    
    .filter-btn {
        padding: 8px 16px;
        font-size: 0.85rem;
    }
    
    .tab-nav {
        justify-content: space-between;
    }
    
    .tab-btn {
        flex: 1;
        padding: 14px 12px;
        font-size: 0.9rem;
    }
    
    .modal-content {
        width: 95%;
        margin: 20px;
        border-radius: 16px;
    }
    
    .modal-header {
        padding: 20px;
    }
    
    .modal-body {
        padding: 20px;
    }
    
    .modal-title {
        font-size: 1.3rem;
    }
    
    .entity-card {
        padding: 16px;
    }
    
    .metrics-list li {
        padding: 10px 12px;
    }
    
    /* === 헤더 배지 그룹 반응형 === */
    .entity-card-header {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
    }
    
    .entity-card-title {
        padding-right: 0;
        margin-bottom: 0;
    }
    
    .header-badges {
        align-items: flex-start;
        justify-content: flex-start;
    }
    
    .header-badges .team-badges {
        justify-content: flex-start;
    }
    
    /* 배지들이 모바일에서 잘 보이도록 */
    .journey-badge,
    .team-badge {
        font-size: 0.75rem;
        padding: 3px 10px;
    }
}

/* 480px 이하 - 작은 모바일 */
@media (max-width: 480px) {
    .header h1 {
        font-size: 1.8rem;
    }
    
    .entity-card-title {
        font-size: 1.1rem;
    }
    
    .stat-number-large {
        font-size: 1.8rem;
    }
}


/* === 탭 네비게이션 === */
.tab-navigation {
    background: linear-gradient(135deg, #f8fafc, #e2e8f0);
    border-bottom: 1px solid #e2e8f0;
    padding: 0;
}

.tab-nav {
    display: flex;
    gap: 0;
    overflow-x: auto;
}

.tab-btn {
    padding: 18px 28px;
    border: none;
    background: none;
    font-size: 1rem;
    font-weight: 600;
    color: #64748b;
    cursor: pointer;
    border-bottom: 4px solid transparent;
    transition: all 0.3s ease;
    white-space: nowrap;
    position: relative;
}

.tab-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
    opacity: 0;
    transition: opacity 0.3s ease;
}

.tab-btn:hover::before {
    opacity: 1;
}

.tab-btn.active {
    color: #667eea;
    border-bottom-color: #667eea;
    background: white;
    box-shadow: 0 -2px 8px rgba(102, 126, 234, 0.1);
}

.tab-btn:hover:not(.active) {
    color: #374151;
    background: rgba(255,255,255,0.7);
}

/* === 탭 콘텐츠 === */
.tab-content {
    display: none;
    padding: 30px;
}

.tab-content.active {
    display: block;
}


/* === 기본 엔터티 카드 === */
.entity-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 16px;
    padding: 24px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.entity-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #667eea, #764ba2);
    transform: scaleX(0);
    transition: transform 0.3s ease;
}

.entity-card:hover::before {
    transform: scaleX(1);
}

.entity-card:hover {
    border-color: #c7d2fe;
}

/* === 엔터티 카드 헤더 개선 === */
.entity-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
    padding-bottom: 16px;
    border-bottom: 1px solid #f1f5f9;
}

.entity-card-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 0;
    color: #1e293b;
    flex: 1;
    padding-right: 16px; /* 제목과 배지 사이 간격 */
}

.entity-card-badge {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    padding: 6px 16px;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 600;
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

/* === 메트릭 리스트 === */
.metrics-list {
    list-style: none;
    padding: 0;
    margin: 16px 0;
}

.metrics-list li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    margin-bottom: 8px;
    background: linear-gradient(135deg, #f8fafc, #f1f5f9);
    border-radius: 10px;
    border: 1px solid #e2e8f0;
    transition: background 0.2s ease;
}

.metrics-list li:hover {
    background: linear-gradient(135deg, #e0f2fe, #e3f2fd);
}

.metrics-list li:last-child {
    margin-bottom: 0;
}

.metric-name {
    font-size: 0.9rem;
    color: #475569;
    font-weight: 500;
}

.metric-number {
    font-size: 1.1rem;
    font-weight: 700;
    color: #667eea;
}

/* === 문의 카드 (모달용) === */
.inquiry-card {
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 16px;
    background: linear-gradient(135deg, #f8fafc, #f1f5f9);
    transition: background 0.3s ease;
    border-left: 4px solid #667eea;
}

.inquiry-card:hover {
    background: linear-gradient(135deg, #e0f2fe, #e3f2fd);
}

.inquiry-card:last-child {
    margin-bottom: 0;
}

/* === 문의 카드 헤더 === */
.inquiry-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    font-size: 0.9rem;
    color: #64748b;
    font-weight: 500;
}

/* === 문의 카드 내용 === */
.inquiry-content {
    color: #374151;
    line-height: 1.6;
    font-size: 0.95rem;
}


/* === 모달 트리거 버튼 === */
.modal-trigger {
    width: 100%;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
    border-radius: 12px;
    padding: 12px 20px;
    margin-top: 16px;
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.modal-trigger:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
}

/* === 기존 필터 버튼 === */
.filter-buttons {
    display: flex;
    gap: 12px;
    margin-bottom: 24px;
    justify-content: center;
    flex-wrap: wrap;
}

.filter-btn {
    padding: 10px 20px;
    border: 2px solid #e2e8f0;
    background: white;
    border-radius: 25px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 600;
    color: #64748b;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.filter-btn:hover {
    border-color: #667eea;
    color: #667eea;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
}

.filter-btn.active {
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-color: #667eea;
    color: white;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

/* === 개선된 필터 컨트롤 === */
.filter-controls {
    display: flex;
    gap: 40px;
    margin-bottom: 24px;
    padding: 24px;
    background: linear-gradient(135deg, #f8fafc, #f1f5f9);
    border-radius: 16px;
    border: 1px solid #e2e8f0;
    flex-wrap: wrap;
    align-items: flex-end;
}

.filter-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.filter-label {
    font-size: 0.9rem;
    font-weight: 600;
    color: #374151;
    margin-bottom: 4px;
}

/* === 세그먼트 선택 드롭다운 === */
.segment-selector {
    position: relative;
}

.segment-dropdown {
    min-width: 180px;
    padding: 10px 16px;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    background: white;
    font-size: 0.9rem;
    font-weight: 600;
    color: #374151;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.segment-dropdown:hover {
    border-color: #667eea;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
}

.segment-dropdown:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.segment-dropdown optgroup {
    font-weight: 700;
    color: #64748b;
    background: #f8fafc;
}

.segment-dropdown option {
    padding: 8px 12px;
    font-weight: 500;
    color: #374151;
}

/* === 정렬 기준 세그먼트 컨트롤 === */
.segment-control {
    display: flex;
    background: white;
    border-radius: 12px;
    border: 2px solid #e2e8f0;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    position: relative;
}

.segment-control input[type="radio"] {
    display: none;
}

.segment-item {
    padding: 10px 16px;
    font-size: 0.9rem;
    font-weight: 600;
    color: #64748b;
    background: white;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    z-index: 2;
    white-space: nowrap;
    text-align: center;
    min-width: 80px;
}

.segment-control input[type="radio"]:checked + .segment-item {
    color: white;
    background: linear-gradient(135deg, #667eea, #764ba2);
    box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
}

.segment-item:hover:not(.segment-control input[type="radio"]:checked + .segment-item) {
    background: #f1f5f9;
    color: #374151;
}

/* 세그먼트 사이 구분선 */
.segment-item:not(:last-child) {
    border-right: 1px solid #e2e8f0;
}

.segment-control input[type="radio"]:checked + .segment-item:not(:last-child) {
    border-right: 1px solid rgba(255, 255, 255, 0.3);
}

/* === 현재 세그먼트 정보 표시 === */
.current-segment-info {
    margin-bottom: 20px;
    padding: 12px 20px;
    background: linear-gradient(135deg, #e0f2fe, #bae6fd);
    border-radius: 12px;
    border-left: 4px solid #0369a1;
}

.segment-indicator {
    font-size: 0.9rem;
    font-weight: 600;
    color: #0c4a6e;
    display: flex;
    align-items: center;
    gap: 8px;
}

/* === 반응형 스타일 === */
@media (max-width: 768px) {
    .filter-controls {
        flex-direction: column;
        gap: 20px;
        padding: 16px;
    }
    
    .filter-group {
        width: 100%;
    }
    
    .segment-dropdown {
        width: 100%;
        min-width: auto;
    }
    
    .segment-control {
        width: 100%;
    }
    
    .segment-item {
        flex: 1;
        padding: 8px 12px;
        font-size: 0.85rem;
        min-width: auto;
    }
    
    .current-segment-info {
        padding: 10px 16px;
    }
    
    .segment-indicator {
        font-size: 0.85rem;
        flex-wrap: wrap;
    }
}

@media (max-width: 480px) {
    .segment-item {
        padding: 6px 8px;
        font-size: 0.8rem;
    }
    
    .segment-dropdown {
        padding: 8px 12px;
        font-size: 0.85rem;
    }
    
    .filter-controls {
        padding: 12px;
    }
}


/* === 헤더 배지 그룹 레이아웃 === */
.header-badges {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
    flex-shrink: 0; /* 배지들이 줄어들지 않도록 */
}

/* === 유저 여정 배지 === */
.journey-badge {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
    white-space: nowrap; /* 줄바꿈 방지 */
}

/* === 팀 배지 === */
.team-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin: 0; /* 기존 마진 제거 */
}

.team-badge {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
    white-space: nowrap; /* 줄바꿈 방지 */
}

/* === 긴급도 배지 === */
.urgency-badge {
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.urgency-urgent {
    background: linear-gradient(135deg, #fee2e2, #fecaca);
    color: #dc2626;
    border: 1px solid #fca5a5;
}

.urgency-normal {
    background: linear-gradient(135deg, #e0f2fe, #bae6fd);
    color: #0369a1;
    border: 1px solid #7dd3fc;
}

/* === 메타 인라인 레이아웃 === */
.meta-inline {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
    margin: 16px 0;
}

.meta-inline .team-badges {
    margin: 0;
}

.meta-inline .journey-badge {
    margin: 0;
}

.metrics-list + .meta-inline {
    margin-top: 8px;
}


/* === 모달 오버레이 === */
.modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

.modal-overlay.active {
    display: flex;
}

/* === 모달 컨텐츠 === */
.modal-content {
    background: white;
    border-radius: 20px;
    width: 90%;
    max-width: 900px;
    max-height: 85vh;
    overflow: hidden;
    box-shadow: 0 25px 80px rgba(0, 0, 0, 0.3);
}

/* === 모달 헤더 === */
.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 25px 30px;
    border-bottom: 1px solid #e2e8f0;
    background: linear-gradient(135deg, #f8fafc, #e2e8f0);
}

.modal-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1e293b;
}

.modal-close {
    background: none;
    border: none;
    font-size: 1.8rem;
    cursor: pointer;
    color: #64748b;
    padding: 8px;
    border-radius: 8px;
    transition: all 0.2s ease;
}

.modal-close:hover {
    background: #f1f5f9;
    color: #374151;
    transform: scale(1.1);
}

/* === 모달 본문 === */
.modal-body {
    padding: 30px;
    max-height: 65vh;
    overflow-y: auto;
}

/* === 스크롤바 스타일 === */
.modal-body::-webkit-scrollbar {
    width: 8px;
}

.modal-body::-webkit-scrollbar-track {
    background: #f1f5f9;
    border-radius: 4px;
}

.modal-body::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 4px;
}

.modal-body::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, #5a67d8, #6b46c1);
}


/* === 메인 통계 그리드 레이아웃 === */
.main-stats-grid {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr;
    gap: 20px;
    margin-bottom: 40px;
}

/* === 대형 통계 카드 === */
.stat-card-large {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    padding: 30px;
    border-radius: 16px;
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
}

.stat-number-large {
    font-size: 3rem;
    font-weight: 700;
    line-height: 1;
    margin-bottom: 5px;
}

.stat-label-large {
    font-size: 1.1rem;
    opacity: 0.9;
    font-weight: 500;
}

/* === 소형 통계 카드 === */
.stat-card-small {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.stat-card-small::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
}

.stat-card-small.urgent::before { background: linear-gradient(90deg, #ef4444, #dc2626); }
.stat-card-small.completed::before { background: linear-gradient(90deg, #10b981, #059669); }
.stat-card-small.pending::before { background: linear-gradient(90deg, #f59e0b, #d97706); }

.stat-number-medium {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 5px;
}

.stat-card-small.urgent .stat-number-medium { color: #dc2626; }
.stat-card-small.completed .stat-number-medium { color: #059669; }
.stat-card-small.pending .stat-number-medium { color: #d97706; }

.stat-label-medium {
    font-size: 0.9rem;
    color: #64748b;
    font-weight: 500;
    margin-bottom: 10px;
}

/* === 프로그레스 바 컴포넌트 === */
.stat-progress {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 10px;
}

.progress-bar-small {
    flex: 1;
    height: 6px;
    background: #f1f5f9;
    border-radius: 3px;
    overflow: hidden;
}

.progress-fill-small {
    height: 100%;
    border-radius: 3px;
    transition: width 0.3s ease;
}

.progress-fill-small.urgent { background: linear-gradient(90deg, #ef4444, #dc2626); }
.progress-fill-small.completed { background: linear-gradient(90deg, #10b981, #059669); }
.progress-fill-small.pending { background: linear-gradient(90deg, #f59e0b, #d97706); }

.progress-text {
    font-size: 0.75rem;
    font-weight: 600;
    color: #64748b;
    min-width: 35px;
}


/* === 분포 그리드 레이아웃 === */
.distribution-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
}

.distribution-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04);
    position: relative;
    overflow: hidden;
}

.distribution-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #667eea, #764ba2);
}

.distribution-card-title {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 20px;
    color: #374151;
    display: flex;
    align-items: center;
    gap: 8px;
}

/* === 순위 아이템 컴포넌트 === */
.simple-rank-item {
    display: flex;
    align-items: center;
    padding: 16px 20px;
    margin-bottom: 12px;
    background: linear-gradient(135deg, #f8fafc, #f1f5f9);
    border-radius: 12px;
    border: 1px solid #e2e8f0;
    transition: all 0.3s ease;
}

.simple-rank-item:hover {
    background: linear-gradient(135deg, #e0f2fe, #e3f2fd);
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
}

.simple-rank-number {
    min-width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    color: white;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    font-size: 1rem;
    margin-right: 20px;
}

.simple-rank-content {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.simple-rank-name {
    font-size: 1rem;
    font-weight: 600;
    color: #374151;
}

.simple-rank-details {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 2px;
}

.simple-rank-count {
    font-size: 1.1rem;
    font-weight: 700;
    color: #667eea;
}

.simple-rank-percentage {
    font-size: 0.85rem;
    color: #64748b;
    font-weight: 500;
}

.rank-summary {
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid #e2e8f0;
    text-align: center;
    font-size: 0.85rem;
    color: #64748b;
    font-weight: 500;
}


/* === 개선된 상세 분석 섹션 === */
.detailed-analysis-section {
    background: linear-gradient(135deg, #f8fafc, #f1f5f9);
    border-top: 1px solid #e2e8f0;
    margin-top: 0;
}

.section-header {
    background: white;
    padding: 24px 30px;
    border-bottom: 1px solid #e2e8f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.section-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1e293b;
    display: flex;
    align-items: center;
    gap: 12px;
    margin: 0;
}

.section-title::before {
    content: '📊';
    font-size: 1.3rem;
}

/* === 통합된 컨트롤 바 === */
.controls-bar {
    background: white;
    padding: 16px 30px;
    border-bottom: 1px solid #e2e8f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 20px;
}

.view-toggle-group {
    display: flex;
    align-items: center;
    gap: 12px;
}

.view-toggle-label {
    font-size: 0.9rem;
    font-weight: 600;
    color: #64748b;
}

.view-toggle-controls {
    display: flex;
    background: #f1f5f9;
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid #e2e8f0;
}

.view-toggle-controls input[type="radio"] {
    display: none;
}

.toggle-btn {
    padding: 8px 16px;
    font-size: 0.9rem;
    font-weight: 600;
    color: #64748b;
    background: transparent;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
    text-align: center;
}

.view-toggle-controls input[type="radio"]:checked + .toggle-btn {
    color: white;
    background: linear-gradient(135deg, #667eea, #764ba2);
    box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
}

.toggle-btn:hover:not(.view-toggle-controls input[type="radio"]:checked + .toggle-btn) {
    background: rgba(102, 126, 234, 0.1);
    color: #374151;
}

.bulk-controls {
    display: flex;
    gap: 8px;
}

.bulk-control-btn {
    padding: 6px 12px;
    border: 1px solid #d1d5db;
    background: white;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.8rem;
    font-weight: 500;
    color: #374151;
    transition: all 0.2s ease;
}

.bulk-control-btn:hover {
    border-color: #667eea;
    color: #667eea;
    background: #f8fafc;
}

/* === 아코디언 컨텐츠 영역 === */
.accordion-content-area {
    background: #f8fafc;
    padding: 20px 30px 30px;
    min-height: 300px;
}

.analysis-view {
    transition: opacity 0.3s ease;
}

.analysis-view:not(.active) {
    display: none;
}

/* === 팀별/여정별 아코디언 컨테이너 === */
.teams-accordion-container,
.journey-accordion-container {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

/* === 아코디언 아이템 (팀별/여정별 공통) === */
.team-accordion-item,
.journey-accordion-item {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.team-accordion-item:hover,
.journey-accordion-item:hover {
    border-color: #c7d2fe;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
}

/* === 아코디언 헤더 (팀별/여정별 공통) === */
.team-accordion-header,
.journey-accordion-header {
    display: flex;
    align-items: center;
    padding: 18px 20px;
    cursor: pointer;
    background: linear-gradient(135deg, #f8fafc, #f1f5f9);
    transition: background 0.3s ease;
}

.team-accordion-header:hover,
.journey-accordion-header:hover {
    background: linear-gradient(135deg, #e0f2fe, #e3f2fd);
}

.team-accordion-item.expanded .team-accordion-header,
.journey-accordion-item.expanded .journey-accordion-header {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.team-summary-info,
.journey-summary-info {
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 200px;
}

.team-name,
.journey-name {
    font-size: 1.1rem;
    font-weight: 600;
    color: #374151;
}

.team-accordion-item.expanded .team-name,
.journey-accordion-item.expanded .journey-name {
    color: white;
}

.team-count,
.journey-count {
    font-size: 0.9rem;
    color: #64748b;
    font-weight: 500;
}

.team-accordion-item.expanded .team-count,
.journey-accordion-item.expanded .journey-count {
    color: rgba(255, 255, 255, 0.9);
}

/* === 프로그레스 컨테이너 (팀별/여정별 공통) === */
.team-progress-container,
.journey-progress-container {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 16px;
    margin: 0 20px;
}

.team-progress-bar,
.journey-progress-bar {
    flex: 1;
    height: 8px;
    background: #e2e8f0;
    border-radius: 4px;
    overflow: hidden;
}

.team-accordion-item.expanded .team-progress-bar,
.journey-accordion-item.expanded .journey-progress-bar {
    background: rgba(255, 255, 255, 0.3);
}

.team-progress-fill,
.journey-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #667eea, #764ba2);
    border-radius: 4px;
    transition: width 0.5s ease;
}

.team-accordion-item.expanded .team-progress-fill,
.journey-accordion-item.expanded .journey-progress-fill {
    background: linear-gradient(90deg, #ffffff, #f1f5f9);
}

.team-percentage,
.journey-percentage {
    font-size: 0.95rem;
    font-weight: 600;
    color: #667eea;
    min-width: 60px;
    text-align: right;
}

.team-accordion-item.expanded .team-percentage,
.journey-accordion-item.expanded .journey-percentage {
    color: white;
}

/* === 토글 버튼 === */
.accordion-toggle-btn {
    background: none;
    border: none;
    padding: 8px;
    cursor: pointer;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.accordion-toggle-btn:hover {
    background: rgba(102, 126, 234, 0.1);
}

.team-accordion-item.expanded .accordion-toggle-btn:hover,
.journey-accordion-item.expanded .accordion-toggle-btn:hover {
    background: rgba(255, 255, 255, 0.2);
}

.toggle-icon {
    font-size: 0.8rem;
    color: #64748b;
    transition: transform 0.3s ease;
}

.team-accordion-item.expanded .toggle-icon,
.journey-accordion-item.expanded .toggle-icon {
    color: white;
    transform: rotate(180deg);
}

/* === 아코디언 콘텐츠 (팀별/여정별 공통) === */
.team-accordion-content,
.journey-accordion-content {
    border-top: 1px solid #e2e8f0;
    background: white;
}

.team-detail-box,
.journey-detail-box {
    padding: 24px;
}

.team-metrics-grid,
.journey-metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
}

.metric-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: linear-gradient(135deg, #f8fafc, #f1f5f9);
    border-radius: 8px;
    border: 1px solid #e2e8f0;
}

.metric-label {
    font-size: 0.9rem;
    color: #64748b;
    font-weight: 500;
}

.metric-value {
    font-size: 1rem;
    font-weight: 600;
    color: #667eea;
}

/* === 반응형 === */
@media (max-width: 768px) {
    .section-header,
    .controls-bar,
    .accordion-content-area {
        padding-left: 20px;
        padding-right: 20px;
    }
    
    .controls-bar {
        flex-direction: column;
        gap: 12px;
        align-items: stretch;
    }
    
    .view-toggle-group {
        justify-content: center;
    }
    
    .bulk-controls {
        justify-content: center;
    }
    
    .team-accordion-header,
    .journey-accordion-header {
        flex-direction: column;
        gap: 12px;
        padding: 16px 20px;
    }
    
    .team-summary-info,
    .journey-summary-info {
        align-self: stretch;
        justify-content: space-between;
        min-width: auto;
    }
    
    .team-progress-container,
    .journey-progress-container {
        align-self: stretch;
        margin: 0;
    }
    
    .team-metrics-grid,
    .journey-metrics-grid {
        grid-template-columns: 1fr;
        gap: 12px;
    }
    
    .team-detail-box,
    .journey-detail-box {
        padding: 16px;
    }
}

@media (max-width: 480px) {
    .section-header {
        padding: 16px 20px;
    }
    
    .section-title {
        font-size: 1.3rem;
    }
    
    .controls-bar {
        padding: 12px 20px;
    }
    
    .view-toggle-label {
        font-size: 0.85rem;
    }
    
    .toggle-btn {
        padding: 6px 12px;
        font-size: 0.85rem;
    }
    
    .bulk-control-btn {
        padding: 5px 10px;
        font-size: 0.75rem;
    }
    
    .team-accordion-header,
    .journey-accordion-header {
        padding: 12px 16px;
    }
    
    .team-name,
    .journey-name {
        font-size: 1rem;
    }
    
    .team-count,
    .journey-count {
        font-size: 0.85rem;
    }
}


/* === 카테고리 테이블 뷰 === */
.category-table-container {
    background: #f8fafc;
    padding: 20px 0;
}

.category-table {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid #e2e8f0;
    margin: 0 20px;
}

/* === 텍스트 옆 아이콘 테이블 필터 헤더 === */
.table-filter-header {
    background: linear-gradient(135deg, #f8fafc, #e2e8f0);
    display: grid;
    grid-template-columns: 2.5fr 1.2fr 1.2fr 0.8fr 0.8fr;
    gap: 0;
    padding: 16px 0;
    border-bottom: 2px solid #667eea;
}

.filter-column {
    display: flex;
    flex-direction: column;
    padding: 0 12px;
    border-right: 1px solid #e2e8f0;
    position: relative;
}

.filter-column:last-child {
    border-right: none;
}

.column-header {
    display: flex;
    align-items: center;
    gap: 6px;
    min-height: 32px;
}

.column-label {
    font-weight: 700;
    color: #374151;
    font-size: 0.95rem;
    line-height: 1.2;
}

/* === 드롭다운 래퍼 === */
.filter-dropdown-wrapper {
    position: relative;
    display: inline-block;
}

/* === 텍스트 옆 아이콘 버튼 스타일 === */
.filter-icon-btn, .sort-icon-btn {
    background: none;
    border: 1px solid #d1d5db;
    border-radius: 3px;
    cursor: pointer;
    padding: 2px;
    transition: all 0.2s ease;
    min-width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6b7280;
    flex-shrink: 0;
}

.filter-icon-btn:hover, .sort-icon-btn:hover {
    background: #f3f4f6;
    border-color: #9ca3af;
    color: #374151;
}

.filter-icon-btn.active {
    background: #667eea;
    border-color: #667eea;
    color: white;
    box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);
}

.sort-icon-btn.active {
    background: #667eea;
    border-color: #667eea;
    color: white;
    box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);
}

.sort-icon-btn.asc svg {
    transform: rotate(180deg);
}

/* === SVG 아이콘 크기 조정 === */
.filter-icon-btn svg, .sort-icon-btn svg {
    width: 10px;
    height: 10px;
    stroke-width: 3;
}

.action-btn svg {
    width: 12px;
    height: 12px;
    stroke-width: 2.5;
}

/* === 오른쪽 아래 드롭다운 메뉴 === */
.dropdown-menu {
    position: absolute;
    top: 20px;
    left: 0;
    background: white;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    min-width: 150px;
    padding: 8px;
}

.dropdown-menu.hidden {
    display: none;
}

.dropdown-filter-input {
    width: 100%;
    padding: 6px 8px;
    border: 1px solid #d1d5db;
    border-radius: 4px;
    font-size: 0.85rem;
    outline: none;
}

.dropdown-filter-input:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
}

.dropdown-filter-select {
    width: 100%;
    padding: 6px 8px;
    border: 1px solid #d1d5db;
    border-radius: 4px;
    background: white;
    font-size: 0.85rem;
    cursor: pointer;
    outline: none;
}

.dropdown-filter-select:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
}

/* === 테이블 데이터 로우 === */
.category-table-body {
    max-height: 600px;
    overflow-y: auto;
}

.category-table-row {
    display: grid;
    grid-template-columns: 2.5fr 1.2fr 1.2fr 0.8fr 0.8fr;
    gap: 0;
    padding: 12px 0;
    border-bottom: 1px solid #e5e7eb;
    transition: background 0.2s ease;
}

.category-table-row > div {
    padding: 0 12px;
    display: flex;
    align-items: center;
    border-right: 1px solid #f3f4f6;
    font-size: 0.9rem;
}

.category-table-row > div:last-child {
    border-right: none;
}

.clickable-category {
    cursor: pointer;
    transition: all 0.2s ease;
    padding: 4px 8px;
    border-radius: 4px;
    margin: -4px -8px;
}

.clickable-category:hover {
    background: #e0f2fe;
    color: #0369a1;
    transform: translateX(2px);
}

.category-table-row:hover {
    background: #f8fafc;
}

.category-table-row:last-child {
    border-bottom: none;
}

.category-table-row.hidden {
    display: none;
}

.category-name {
    font-weight: 600;
    color: #374151;
    line-height: 1.3;
}

.team-badge, .journey-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
    display: inline-block;
}

.team-badge {
    background: #fef3c7;
    color: #92400e;
}

.journey-badge {
    background: #d1fae5;
    color: #065f46;
}

.metric-value {
    font-weight: 600;
    color: #667eea;
}

.urgent-rate {
    font-weight: 600;
}

.urgent-rate.high {
    color: #dc2626;
}

.urgent-rate.medium {
    color: #d97706;
}

.urgent-rate.low {
    color: #059669;
}

.action-btn {
    background: #667eea;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 32px;
    height: 32px;
}

.action-btn:hover {
    background: #5b67d8;
    transform: scale(1.05);
}

/* === 새 모달 스타일 === */
.new-modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
    z-index: 10000;
    justify-content: center;
    align-items: center;
}

.new-modal-overlay.active {
    display: flex;
}

.new-modal-content {
    background: white;
    border-radius: 16px;
    width: 90%;
    max-width: 800px;
    max-height: 80vh;
    overflow: hidden;
    box-shadow: 0 25px 80px rgba(0, 0, 0, 0.3);
}

.new-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px;
    border-bottom: 1px solid #e2e8f0;
    background: linear-gradient(135deg, #f8fafc, #e2e8f0);
}

.new-modal-title {
    font-size: 1.4rem;
    font-weight: 700;
    color: #1e293b;
    margin: 0;
}

.new-modal-close {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: #64748b;
    padding: 4px;
    border-radius: 4px;
    transition: all 0.2s ease;
}

.new-modal-close:hover {
    background: #f1f5f9;
    color: #374151;
}

.new-modal-body {
    padding: 24px;
    max-height: 60vh;
    overflow-y: auto;
}

/* === 필터 상태 표시 === */
.table-filter-status {
    background: #dbeafe;
    padding: 12px 20px;
    margin: 0 20px;
    border-radius: 6px 6px 0 0;
    font-size: 0.9rem;
    color: #1e40af;
    border: 1px solid #bfdbfe;
    border-bottom: none;
}

.clear-table-filters {
    background: none;
    border: none;
    color: #667eea;
    cursor: pointer;
    text-decoration: underline;
    font-size: 0.85rem;
    margin-left: 10px;
}

.clear-table-filters:hover {
    color: #5b67d8;
}

/* === 테이블 컨트롤 버튼 === */
.table-controls {
    display: none;
}

.table-controls.active {
    display: flex;
}

.accordion-controls.hidden {
    display: none;
}

/* === 스크롤바 스타일 === */
.category-table-body::-webkit-scrollbar,
.new-modal-body::-webkit-scrollbar {
    width: 6px;
}

.category-table-body::-webkit-scrollbar-track,
.new-modal-body::-webkit-scrollbar-track {
    background: #f1f5f9;
}

.category-table-body::-webkit-scrollbar-thumb,
.new-modal-body::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 3px;
}

.category-table-body::-webkit-scrollbar-thumb:hover,
.new-modal-body::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
}

/* === 반응형 === */
@media (max-width: 768px) {
    .table-filter-header, 
    .category-table-row {
        grid-template-columns: 1fr;
        gap: 8px;
    }
    
    .filter-column {
        margin-bottom: 8px;
        border-right: none;
        border-bottom: 1px solid #e2e8f0;
        padding-bottom: 8px;
    }
    
    .filter-column:last-child {
        border-bottom: none;
    }
    
    .dropdown-menu {
        position: static;
        box-shadow: none;
        border: 1px solid #d1d5db;
        margin-top: 4px;
        width: 100%;
    }
    
    .category-table-container {
        padding: 10px 0;
    }
    
    .category-table {
        margin: 0 10px;
    }
    
    .table-filter-status {
        margin: 0 10px;
        padding: 8px 15px;
    }
    
    .category-table-row > div {
        border-right: none;
        border-bottom: 1px solid #f3f4f6;
        padding: 8px 12px;
    }
    
    .category-table-row > div:last-child {
        border-bottom: none;
    }
    
    .new-modal-content {
        width: 95%;
        margin: 20px;
    }
    
    .new-modal-header {
        padding: 16px 20px;
    }
    
    .new-modal-body {
        padding: 20px;
    }
}

@media (max-width: 480px) {
    .table-filter-header, 
    .category-table-row {
        padding: 10px 15px;
    }
    
    .filter-icon-btn, .sort-icon-btn {
        min-width: 14px;
        height: 14px;
    }
    
    .filter-icon-btn svg, .sort-icon-btn svg {
        width: 8px;
        height: 8px;
    }
    
    .action-btn svg {
        width: 10px;
        height: 10px;
    }
}
</style>
</head>
<body>
    <div class="container">
        <div class="header">
    <h1>카테고리 기반 VoC 분석</h1>
    <p>고객 문의 데이터의 카테고리별 분석 및 인사이트 도출</p>
    <div class="analysis-date">분석 기준일: 2025-06-11 17:32:13</div>
</div>

        <!-- 탭 네비게이션 (2개 탭) -->
        <div class="tab-navigation">
            <div class="tab-nav">
                <button class="tab-btn active"
                        onclick="switchTab('overview')">📊 통합 분석</button>
                <button class="tab-btn"
                        onclick="switchTab('categories')">📂 세부 카테고리</button>
            </div>
        </div>

        <div class="main-content">
            
            <!-- 통합 분석 개요 탭 -->
<div id="overview" class="tab-content active">
    <!-- 전체 현황 -->
    <div class="main-stats-grid">
        <div class="stat-card-large">
            <div class="stat-info">
                <div class="stat-number-large">885</div>
                <div class="stat-label-large">총 문의</div>
            </div>
        </div>
        <div class="stat-card-small urgent">
            <div class="stat-number-medium">106</div>
            <div class="stat-label-medium">긴급 문의</div>
            <div class="stat-progress">
                <div class="progress-bar-small">
                    <div class="progress-fill-small urgent" style="width: 12.0%"></div>
                </div>
                <span class="progress-text">12.0%</span>
            </div>
        </div>
        <div class="stat-card-small completed">
            <div class="stat-number-medium">746</div>
            <div class="stat-label-medium">답변 완료</div>
            <div class="stat-progress">
                <div class="progress-bar-small">
                    <div class="progress-fill-small completed" style="width: 84.3%"></div>
                </div>
                <span class="progress-text">84.3%</span>
            </div>
        </div>
        <div class="stat-card-small pending">
            <div class="stat-number-medium">139</div>
            <div class="stat-label-medium">답변 대기</div>
            <div class="stat-progress">
                <div class="progress-bar-small">
                    <div class="progress-fill-small pending" style="width: 15.7%"></div>
                </div>
                <span class="progress-text">15.7%</span>
            </div>
        </div>
    </div>
    
    <!-- 상세 분석 섹션 -->
    <div class="detailed-analysis-section">
        <!-- 섹션 헤더 -->
        <div class="section-header">
            <h2 class="section-title">상세 분석</h2>
        </div>

        <!-- 통합 컨트롤 바 -->
        <div class="controls-bar">
            <div class="view-toggle-group">
                <span class="view-toggle-label">보기 방식:</span>
                <div class="view-toggle-controls">
                    <input type="radio" id="view-teams" name="analysis-view" value="teams" checked>
                    <label for="view-teams" class="toggle-btn">👥 팀별 보기</label>
                    
                    <input type="radio" id="view-journey" name="analysis-view" value="journey">
                    <label for="view-journey" class="toggle-btn">🎯 여정별 보기</label>
                    
                    <input type="radio" id="view-categories" name="analysis-view" value="categories">
                    <label for="view-categories" class="toggle-btn">📂 카테고리별 보기</label>
                </div>
            </div>
            
            <!-- 아코디언 컨트롤 (팀별/여정별일 때) -->
            <div class="bulk-controls accordion-controls">
                <button class="bulk-control-btn" onclick="expandAllAccordions()">전체 펼치기</button>
                <button class="bulk-control-btn" onclick="collapseAllAccordions()">전체 접기</button>
            </div>
            
            <!-- 테이블 컨트롤 (카테고리별일 때) -->
            <div class="bulk-controls table-controls" style="display: none;">
                <button class="bulk-control-btn" onclick="resetTableFilters()">🔄 필터 초기화</button>
                <button class="bulk-control-btn" onclick="exportTableData()">📥 내보내기</button>
            </div>
        </div>

        <!-- 아코디언 컨텐츠 영역 -->
        <div class="accordion-content-area">
            <!-- 팀별 아코디언 뷰 -->
            <div id="teams-accordion-view" class="analysis-view active">
                <div class="teams-accordion-container">
                    
        <div class="team-accordion-item">
            <div class="team-accordion-header" onclick="toggleTeamAccordion('CS')">
                <div class="team-summary-info">
                    <span class="team-name">CS</span>
                    <span class="team-count">(585건)</span>
                </div>
                <div class="team-progress-container">
                    <div class="team-progress-bar">
                        <div class="team-progress-fill" style="width: 100.0%"></div>
                    </div>
                    <span class="team-percentage">76.5%</span>
                </div>
                <button class="accordion-toggle-btn" id="btn-CS">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="team-accordion-content" id="content-CS" style="display: none;">
                <div class="team-detail-box">
                    <div class="team-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">585건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">102건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">570건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">97.4%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">115자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">반품관리/환불보류</span><span class="simple-value">216건</span></div><div class="simple-item"><span class="simple-rank">2</span><span class="simple-name">교환관리/교환철회</span><span class="simple-value">147건</span></div><div class="simple-item"><span class="simple-rank">3</span><span class="simple-name">긴급문의</span><span class="simple-value">81건</span></div><div class="simple-item"><span class="simple-rank">4</span><span class="simple-name">배송지연 관리 (결품취소)</span><span class="simple-value">50건</span></div><div class="simple-item"><span class="simple-rank">5</span><span class="simple-name">취소관리</span><span class="simple-value">44건</span></div></div>
                </div>
            </div>
        </div>
        <div class="team-accordion-item">
            <div class="team-accordion-header" onclick="toggleTeamAccordion('MD(사업부)')">
                <div class="team-summary-info">
                    <span class="team-name">MD(사업부)</span>
                    <span class="team-count">(111건)</span>
                </div>
                <div class="team-progress-container">
                    <div class="team-progress-bar">
                        <div class="team-progress-fill" style="width: 18.974358974358974%"></div>
                    </div>
                    <span class="team-percentage">14.5%</span>
                </div>
                <button class="accordion-toggle-btn" id="btn-MD(사업부)">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="team-accordion-content" id="content-MD(사업부)" style="display: none;">
                <div class="team-detail-box">
                    <div class="team-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">111건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">2건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">108건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">97.3%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">92자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">상품 조회 및 수정</span><span class="simple-value">41건</span></div><div class="simple-item"><span class="simple-rank">2</span><span class="simple-name">채널상품연동</span><span class="simple-value">25건</span></div><div class="simple-item"><span class="simple-rank">3</span><span class="simple-name">상품등록</span><span class="simple-value">23건</span></div><div class="simple-item"><span class="simple-rank">4</span><span class="simple-name">스토어관리</span><span class="simple-value">15건</span></div><div class="simple-item"><span class="simple-rank">5</span><span class="simple-name">상품문의(브리치)</span><span class="simple-value">4건</span></div></div>
                </div>
            </div>
        </div>
        <div class="team-accordion-item">
            <div class="team-accordion-header" onclick="toggleTeamAccordion('재무')">
                <div class="team-summary-info">
                    <span class="team-name">재무</span>
                    <span class="team-count">(42건)</span>
                </div>
                <div class="team-progress-container">
                    <div class="team-progress-bar">
                        <div class="team-progress-fill" style="width: 7.179487179487179%"></div>
                    </div>
                    <span class="team-percentage">5.5%</span>
                </div>
                <button class="accordion-toggle-btn" id="btn-재무">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="team-accordion-content" id="content-재무" style="display: none;">
                <div class="team-detail-box">
                    <div class="team-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">42건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">0건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">42건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">100.0%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">113자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">특약매입정산</span><span class="simple-value">23건</span></div><div class="simple-item"><span class="simple-rank">2</span><span class="simple-name">정산통합</span><span class="simple-value">8건</span></div><div class="simple-item"><span class="simple-rank">3</span><span class="simple-name">구매확정관리</span><span class="simple-value">4건</span></div><div class="simple-item"><span class="simple-rank">4</span><span class="simple-name">판매대행정산</span><span class="simple-value">4건</span></div><div class="simple-item"><span class="simple-rank">5</span><span class="simple-name">사업자정보/양도양수</span><span class="simple-value">3건</span></div></div>
                </div>
            </div>
        </div>
        <div class="team-accordion-item">
            <div class="team-accordion-header" onclick="toggleTeamAccordion('영업')">
                <div class="team-summary-info">
                    <span class="team-name">영업</span>
                    <span class="team-count">(24건)</span>
                </div>
                <div class="team-progress-container">
                    <div class="team-progress-bar">
                        <div class="team-progress-fill" style="width: 4.102564102564102%"></div>
                    </div>
                    <span class="team-percentage">3.1%</span>
                </div>
                <button class="accordion-toggle-btn" id="btn-영업">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="team-accordion-content" id="content-영업" style="display: none;">
                <div class="team-detail-box">
                    <div class="team-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">24건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">0건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">23건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">95.8%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">64자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">플랜관리</span><span class="simple-value">15건</span></div><div class="simple-item"><span class="simple-rank">2</span><span class="simple-name">탈퇴/재가입</span><span class="simple-value">6건</span></div><div class="simple-item"><span class="simple-rank">3</span><span class="simple-name">신규회원가입</span><span class="simple-value">2건</span></div><div class="simple-item"><span class="simple-rank">4</span><span class="simple-name">입점관리</span><span class="simple-value">1건</span></div></div>
                </div>
            </div>
        </div>
        <div class="team-accordion-item">
            <div class="team-accordion-header" onclick="toggleTeamAccordion('개발')">
                <div class="team-summary-info">
                    <span class="team-name">개발</span>
                    <span class="team-count">(1건)</span>
                </div>
                <div class="team-progress-container">
                    <div class="team-progress-bar">
                        <div class="team-progress-fill" style="width: 0.17094017094017094%"></div>
                    </div>
                    <span class="team-percentage">0.1%</span>
                </div>
                <button class="accordion-toggle-btn" id="btn-개발">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="team-accordion-content" id="content-개발" style="display: none;">
                <div class="team-detail-box">
                    <div class="team-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">1건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">0건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">1건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">100.0%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">67자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">상품등록 실패</span><span class="simple-value">1건</span></div></div>
                </div>
            </div>
        </div>
        <div class="team-accordion-item">
            <div class="team-accordion-header" onclick="toggleTeamAccordion('마케팅')">
                <div class="team-summary-info">
                    <span class="team-name">마케팅</span>
                    <span class="team-count">(1건)</span>
                </div>
                <div class="team-progress-container">
                    <div class="team-progress-bar">
                        <div class="team-progress-fill" style="width: 0.17094017094017094%"></div>
                    </div>
                    <span class="team-percentage">0.1%</span>
                </div>
                <button class="accordion-toggle-btn" id="btn-마케팅">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="team-accordion-content" id="content-마케팅" style="display: none;">
                <div class="team-detail-box">
                    <div class="team-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">1건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">0건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">1건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">100.0%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">18자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">브리치 기획전신청</span><span class="simple-value">1건</span></div></div>
                </div>
            </div>
        </div>
        <div class="team-accordion-item">
            <div class="team-accordion-header" onclick="toggleTeamAccordion('정책')">
                <div class="team-summary-info">
                    <span class="team-name">정책</span>
                    <span class="team-count">(1건)</span>
                </div>
                <div class="team-progress-container">
                    <div class="team-progress-bar">
                        <div class="team-progress-fill" style="width: 0.17094017094017094%"></div>
                    </div>
                    <span class="team-percentage">0.1%</span>
                </div>
                <button class="accordion-toggle-btn" id="btn-정책">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="team-accordion-content" id="content-정책" style="display: none;">
                <div class="team-detail-box">
                    <div class="team-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">1건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">0건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">1건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">100.0%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">64자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">배송정책 관리</span><span class="simple-value">1건</span></div></div>
                </div>
            </div>
        </div>
                </div>
            </div>
            
            <!-- 여정별 아코디언 뷰 -->
            <div id="journey-accordion-view" class="analysis-view" style="display: none;">
                <div class="journey-accordion-container">
                    
        <div class="journey-accordion-item">
            <div class="journey-accordion-header" onclick="toggleJourneyAccordion('반품취소')">
                <div class="journey-summary-info">
                    <span class="journey-name">반품·취소</span>
                    <span class="journey-count">(407건)</span>
                </div>
                <div class="journey-progress-container">
                    <div class="journey-progress-bar">
                        <div class="journey-progress-fill" style="width: 100.0%"></div>
                    </div>
                    <span class="journey-percentage">46.0%</span>
                </div>
                <button class="accordion-toggle-btn" id="journey-btn-반품취소">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="journey-accordion-content" id="journey-content-반품취소" style="display: none;">
                <div class="journey-detail-box">
                    <div class="journey-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">407건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">91건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">397건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">97.5%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">119자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">반품관리/환불보류</span><span class="simple-value">216건</span></div><div class="simple-item"><span class="simple-rank">2</span><span class="simple-name">교환관리/교환철회</span><span class="simple-value">147건</span></div><div class="simple-item"><span class="simple-rank">3</span><span class="simple-name">취소관리</span><span class="simple-value">44건</span></div></div>
                </div>
            </div>
        </div>
        <div class="journey-accordion-item">
            <div class="journey-accordion-header" onclick="toggleJourneyAccordion('주문배송')">
                <div class="journey-summary-info">
                    <span class="journey-name">주문·배송</span>
                    <span class="journey-count">(179건)</span>
                </div>
                <div class="journey-progress-container">
                    <div class="journey-progress-bar">
                        <div class="journey-progress-fill" style="width: 43.980343980343974%"></div>
                    </div>
                    <span class="journey-percentage">20.2%</span>
                </div>
                <button class="accordion-toggle-btn" id="journey-btn-주문배송">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="journey-accordion-content" id="journey-content-주문배송" style="display: none;">
                <div class="journey-detail-box">
                    <div class="journey-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">179건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">11건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">174건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">97.2%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">107자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">긴급문의</span><span class="simple-value">81건</span></div><div class="simple-item"><span class="simple-rank">2</span><span class="simple-name">배송지연 관리 (결품취소)</span><span class="simple-value">50건</span></div><div class="simple-item"><span class="simple-rank">3</span><span class="simple-name">발주/발송관리</span><span class="simple-value">28건</span></div><div class="simple-item"><span class="simple-rank">4</span><span class="simple-name">배송현황관리</span><span class="simple-value">8건</span></div><div class="simple-item"><span class="simple-rank">5</span><span class="simple-name">송장등록 실패/ 송장번호 수정</span><span class="simple-value">7건</span></div></div>
                </div>
            </div>
        </div>
        <div class="journey-accordion-item">
            <div class="journey-accordion-header" onclick="toggleJourneyAccordion('기타')">
                <div class="journey-summary-info">
                    <span class="journey-name">기타</span>
                    <span class="journey-count">(120건)</span>
                </div>
                <div class="journey-progress-container">
                    <div class="journey-progress-bar">
                        <div class="journey-progress-fill" style="width: 29.484029484029485%"></div>
                    </div>
                    <span class="journey-percentage">13.6%</span>
                </div>
                <button class="accordion-toggle-btn" id="journey-btn-기타">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="journey-accordion-content" id="journey-content-기타" style="display: none;">
                <div class="journey-detail-box">
                    <div class="journey-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">120건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">2건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">120건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">100.0%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">144자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">기타</span><span class="simple-value">120건</span></div></div>
                </div>
            </div>
        </div>
        <div class="journey-accordion-item">
            <div class="journey-accordion-header" onclick="toggleJourneyAccordion('상품콘텐츠')">
                <div class="journey-summary-info">
                    <span class="journey-name">상품·콘텐츠</span>
                    <span class="journey-count">(97건)</span>
                </div>
                <div class="journey-progress-container">
                    <div class="journey-progress-bar">
                        <div class="journey-progress-fill" style="width: 23.832923832923832%"></div>
                    </div>
                    <span class="journey-percentage">11.0%</span>
                </div>
                <button class="accordion-toggle-btn" id="journey-btn-상품콘텐츠">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="journey-accordion-content" id="journey-content-상품콘텐츠" style="display: none;">
                <div class="journey-detail-box">
                    <div class="journey-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">97건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">1건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">94건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">96.9%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">84자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">상품 조회 및 수정</span><span class="simple-value">41건</span></div><div class="simple-item"><span class="simple-rank">2</span><span class="simple-name">채널상품연동</span><span class="simple-value">25건</span></div><div class="simple-item"><span class="simple-rank">3</span><span class="simple-name">상품등록</span><span class="simple-value">23건</span></div><div class="simple-item"><span class="simple-rank">4</span><span class="simple-name">상품문의(브리치)</span><span class="simple-value">4건</span></div><div class="simple-item"><span class="simple-rank">5</span><span class="simple-name">브리치 기획전신청</span><span class="simple-value">1건</span></div></div>
                </div>
            </div>
        </div>
        <div class="journey-accordion-item">
            <div class="journey-accordion-header" onclick="toggleJourneyAccordion('계정입점')">
                <div class="journey-summary-info">
                    <span class="journey-name">계정·입점</span>
                    <span class="journey-count">(43건)</span>
                </div>
                <div class="journey-progress-container">
                    <div class="journey-progress-bar">
                        <div class="journey-progress-fill" style="width: 10.565110565110565%"></div>
                    </div>
                    <span class="journey-percentage">4.9%</span>
                </div>
                <button class="accordion-toggle-btn" id="journey-btn-계정입점">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="journey-accordion-content" id="journey-content-계정입점" style="display: none;">
                <div class="journey-detail-box">
                    <div class="journey-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">43건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">1건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">42건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">97.7%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">89자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">플랜관리</span><span class="simple-value">15건</span></div><div class="simple-item"><span class="simple-rank">2</span><span class="simple-name">스토어관리</span><span class="simple-value">15건</span></div><div class="simple-item"><span class="simple-rank">3</span><span class="simple-name">탈퇴/재가입</span><span class="simple-value">6건</span></div><div class="simple-item"><span class="simple-rank">4</span><span class="simple-name">사업자정보/양도양수</span><span class="simple-value">3건</span></div><div class="simple-item"><span class="simple-rank">5</span><span class="simple-name">신규회원가입</span><span class="simple-value">2건</span></div></div>
                </div>
            </div>
        </div>
        <div class="journey-accordion-item">
            <div class="journey-accordion-header" onclick="toggleJourneyAccordion('정산')">
                <div class="journey-summary-info">
                    <span class="journey-name">정산</span>
                    <span class="journey-count">(39건)</span>
                </div>
                <div class="journey-progress-container">
                    <div class="journey-progress-bar">
                        <div class="journey-progress-fill" style="width: 9.582309582309582%"></div>
                    </div>
                    <span class="journey-percentage">4.4%</span>
                </div>
                <button class="accordion-toggle-btn" id="journey-btn-정산">
                    <span class="toggle-icon">▼</span>
                </button>
            </div>
            <div class="journey-accordion-content" id="journey-content-정산" style="display: none;">
                <div class="journey-detail-box">
                    <div class="journey-metrics-grid">
                        <div class="metric-item">
                            <span class="metric-label">총 문의</span>
                            <span class="metric-value">39건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">긴급 문의</span>
                            <span class="metric-value">0건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변 완료</span>
                            <span class="metric-value">39건</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">답변률</span>
                            <span class="metric-value">100.0%</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">평균 길이</span>
                            <span class="metric-value">120자</span>
                        </div>
                    </div>
                    <div class="simple-list"><h5 class="simple-list-title">세부 카테고리 분포</h5><div class="simple-item"><span class="simple-rank">1</span><span class="simple-name">특약매입정산</span><span class="simple-value">23건</span></div><div class="simple-item"><span class="simple-rank">2</span><span class="simple-name">정산통합</span><span class="simple-value">8건</span></div><div class="simple-item"><span class="simple-rank">3</span><span class="simple-name">구매확정관리</span><span class="simple-value">4건</span></div><div class="simple-item"><span class="simple-rank">4</span><span class="simple-name">판매대행정산</span><span class="simple-value">4건</span></div></div>
                </div>
            </div>
        </div>
                </div>
            </div>
            
            <!-- 카테고리별 테이블 뷰 -->
            <div id="categories-table-view" class="analysis-view" style="display: none;">
                <!-- 필터 상태 표시 -->
                <div class="table-filter-status" id="table-filter-status">
                    📂 <strong>전체 카테고리</strong> 표시 중 (<span id="visible-categories-count">0</span>개)
                    <button class="clear-table-filters" onclick="clearAllTableFilters()" style="display: none;">모든 필터 지우기</button>
                </div>
                
                <!-- 테이블 컨테이너 -->
                <div class="category-table-container">
                    <div class="category-table">
                        <!-- 텍스트 옆 아이콘 + 드롭다운 헤더 -->
                        <div class="table-filter-header">
                            <div class="filter-column">
                                <div class="column-header">
                                    <span class="column-label">카테고리명</span>
                                    <div class="filter-dropdown-wrapper">
                                        <button class="filter-icon-btn" onclick="toggleSearchFilter()" title="카테고리 검색">
                                            <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                                <circle cx="11" cy="11" r="8"></circle>
                                                <path d="m21 21-4.35-4.35"></path>
                                            </svg>
                                        </button>
                                        <div class="dropdown-menu hidden" id="search-dropdown">
                                            <input type="text" class="dropdown-filter-input" id="category-search-input" 
                                                   placeholder="카테고리 검색..." oninput="filterByCategory(this.value)">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="filter-column">
                                <div class="column-header">
                                    <span class="column-label">담당팀</span>
                                    <div class="filter-dropdown-wrapper">
                                        <button class="filter-icon-btn" onclick="toggleTeamFilter()" title="팀 필터">
                                            <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                                <path d="M6 9l6 6 6-6"></path>
                                            </svg>
                                        </button>
                                        <div class="dropdown-menu hidden" id="team-dropdown">
                                            <select class="dropdown-filter-select" id="team-filter-dropdown" onchange="filterByTeam(this.value)">
                                                <option value="">모든 팀</option>
                                                <option value="CS">CS</option>
                                                <option value="MD(사업부)">MD(사업부)</option>
                                                <option value="개발">개발</option>
                                                <option value="마케팅">마케팅</option>
                                                <option value="영업">영업</option>
                                                <option value="재무">재무</option>
                                                <option value="정책">정책</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="filter-column">
                                <div class="column-header">
                                    <span class="column-label">유저여정</span>
                                    <div class="filter-dropdown-wrapper">
                                        <button class="filter-icon-btn" onclick="toggleJourneyFilter()" title="여정 필터">
                                            <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                                <path d="M6 9l6 6 6-6"></path>
                                            </svg>
                                        </button>
                                        <div class="dropdown-menu hidden" id="journey-dropdown">
                                            <select class="dropdown-filter-select" id="journey-filter-dropdown" onchange="filterByJourney(this.value)">
                                                <option value="">모든 여정</option>
                                                <option value="계정·입점">계정·입점</option>
                                                <option value="상품·콘텐츠">상품·콘텐츠</option>
                                                <option value="주문·배송">주문·배송</option>
                                                <option value="반품·취소">반품·취소</option>
                                                <option value="정산">정산</option>
                                                <option value="기타">기타</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="filter-column">
                                <div class="column-header">
                                    <span class="column-label">문의수</span>
                                    <button class="sort-icon-btn" onclick="sortByInquiries()" id="inquiries-sort" title="문의수 정렬">
                                        <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                            <path d="M7 13l5 5 5-5"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="filter-column">
                                <div class="column-header">
                                    <span class="column-label">긴급률</span>
                                    <button class="sort-icon-btn" onclick="sortByUrgent()" id="urgent-sort" title="긴급률 정렬">
                                        <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                            <path d="M7 13l5 5 5-5"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="filter-column">
                                <div class="column-header">
                                    <span class="column-label">상세보기</span>
                                </div>
                            </div>
                        </div>

                        <!-- 카테고리 데이터 로우들 -->
                        <div class="category-table-body" id="category-table-body">
                            <div class="category-table-row" 
             data-team="CS" 
             data-journey="반품·취소" 
             data-inquiries="216" 
             data-urgent="21.8"
             data-category="반품관리/환불보류"
             data-category-name="반품관리/환불보류">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">반품관리/환불보류</div>
    <div><span class="team-badge">CS</span></div>
    <div><span class="journey-badge">반품·취소</span></div>
    <div class="metric-value">216건</div>
    <div class="urgent-rate high">21.8%</div>
</div><div class="category-table-row" 
             data-team="CS" 
             data-journey="반품·취소" 
             data-inquiries="147" 
             data-urgent="27.9"
             data-category="교환관리/교환철회"
             data-category-name="교환관리/교환철회">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">교환관리/교환철회</div>
    <div><span class="team-badge">CS</span></div>
    <div><span class="journey-badge">반품·취소</span></div>
    <div class="metric-value">147건</div>
    <div class="urgent-rate high">27.9%</div>
</div><div class="category-table-row" 
             data-team="기타" 
             data-journey="기타" 
             data-inquiries="120" 
             data-urgent="1.7"
             data-category="기타"
             data-category-name="기타">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">기타</div>
    <div><span class="team-badge">기타</span></div>
    <div><span class="journey-badge">기타</span></div>
    <div class="metric-value">120건</div>
    <div class="urgent-rate low">1.7%</div>
</div><div class="category-table-row" 
             data-team="CS" 
             data-journey="주문·배송" 
             data-inquiries="81" 
             data-urgent="0.0"
             data-category="긴급문의"
             data-category-name="긴급문의">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">긴급문의</div>
    <div><span class="team-badge">CS</span></div>
    <div><span class="journey-badge">주문·배송</span></div>
    <div class="metric-value">81건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="CS" 
             data-journey="주문·배송" 
             data-inquiries="50" 
             data-urgent="8.0"
             data-category="배송지연 관리 (결품취소)"
             data-category-name="배송지연 관리 (결품취소)">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">배송지연 관리 (결품취소)</div>
    <div><span class="team-badge">CS</span></div>
    <div><span class="journey-badge">주문·배송</span></div>
    <div class="metric-value">50건</div>
    <div class="urgent-rate low">8.0%</div>
</div><div class="category-table-row" 
             data-team="CS" 
             data-journey="반품·취소" 
             data-inquiries="44" 
             data-urgent="6.8"
             data-category="취소관리"
             data-category-name="취소관리">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">취소관리</div>
    <div><span class="team-badge">CS</span></div>
    <div><span class="journey-badge">반품·취소</span></div>
    <div class="metric-value">44건</div>
    <div class="urgent-rate low">6.8%</div>
</div><div class="category-table-row" 
             data-team="MD(사업부)" 
             data-journey="상품·콘텐츠" 
             data-inquiries="41" 
             data-urgent="0.0"
             data-category="상품 조회 및 수정"
             data-category-name="상품 조회 및 수정">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">상품 조회 및 수정</div>
    <div><span class="team-badge">MD(사업부)</span></div>
    <div><span class="journey-badge">상품·콘텐츠</span></div>
    <div class="metric-value">41건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="CS" 
             data-journey="주문·배송" 
             data-inquiries="28" 
             data-urgent="21.4"
             data-category="발주/발송관리"
             data-category-name="발주/발송관리">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">발주/발송관리</div>
    <div><span class="team-badge">CS</span></div>
    <div><span class="journey-badge">주문·배송</span></div>
    <div class="metric-value">28건</div>
    <div class="urgent-rate high">21.4%</div>
</div><div class="category-table-row" 
             data-team="MD(사업부)" 
             data-journey="상품·콘텐츠" 
             data-inquiries="25" 
             data-urgent="4.0"
             data-category="채널상품연동"
             data-category-name="채널상품연동">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">채널상품연동</div>
    <div><span class="team-badge">MD(사업부)</span></div>
    <div><span class="journey-badge">상품·콘텐츠</span></div>
    <div class="metric-value">25건</div>
    <div class="urgent-rate low">4.0%</div>
</div><div class="category-table-row" 
             data-team="MD(사업부)" 
             data-journey="상품·콘텐츠" 
             data-inquiries="23" 
             data-urgent="0.0"
             data-category="상품등록"
             data-category-name="상품등록">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">상품등록</div>
    <div><span class="team-badge">MD(사업부)</span></div>
    <div><span class="journey-badge">상품·콘텐츠</span></div>
    <div class="metric-value">23건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="재무" 
             data-journey="정산" 
             data-inquiries="23" 
             data-urgent="0.0"
             data-category="특약매입정산"
             data-category-name="특약매입정산">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">특약매입정산</div>
    <div><span class="team-badge">재무</span></div>
    <div><span class="journey-badge">정산</span></div>
    <div class="metric-value">23건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="MD(사업부)" 
             data-journey="계정·입점" 
             data-inquiries="15" 
             data-urgent="6.7"
             data-category="스토어관리"
             data-category-name="스토어관리">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">스토어관리</div>
    <div><span class="team-badge">MD(사업부)</span></div>
    <div><span class="journey-badge">계정·입점</span></div>
    <div class="metric-value">15건</div>
    <div class="urgent-rate low">6.7%</div>
</div><div class="category-table-row" 
             data-team="영업" 
             data-journey="계정·입점" 
             data-inquiries="15" 
             data-urgent="0.0"
             data-category="플랜관리"
             data-category-name="플랜관리">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">플랜관리</div>
    <div><span class="team-badge">영업</span></div>
    <div><span class="journey-badge">계정·입점</span></div>
    <div class="metric-value">15건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="CS" 
             data-journey="주문·배송" 
             data-inquiries="8" 
             data-urgent="12.5"
             data-category="배송현황관리"
             data-category-name="배송현황관리">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">배송현황관리</div>
    <div><span class="team-badge">CS</span></div>
    <div><span class="journey-badge">주문·배송</span></div>
    <div class="metric-value">8건</div>
    <div class="urgent-rate medium">12.5%</div>
</div><div class="category-table-row" 
             data-team="재무" 
             data-journey="정산" 
             data-inquiries="8" 
             data-urgent="0.0"
             data-category="정산통합"
             data-category-name="정산통합">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">정산통합</div>
    <div><span class="team-badge">재무</span></div>
    <div><span class="journey-badge">정산</span></div>
    <div class="metric-value">8건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="CS" 
             data-journey="주문·배송" 
             data-inquiries="7" 
             data-urgent="0.0"
             data-category="송장등록 실패/ 송장번호 수정"
             data-category-name="송장등록 실패/ 송장번호 수정">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">송장등록 실패/ 송장번호 수정</div>
    <div><span class="team-badge">CS</span></div>
    <div><span class="journey-badge">주문·배송</span></div>
    <div class="metric-value">7건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="영업" 
             data-journey="계정·입점" 
             data-inquiries="6" 
             data-urgent="0.0"
             data-category="탈퇴/재가입"
             data-category-name="탈퇴/재가입">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">탈퇴/재가입</div>
    <div><span class="team-badge">영업</span></div>
    <div><span class="journey-badge">계정·입점</span></div>
    <div class="metric-value">6건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="재무" 
             data-journey="정산" 
             data-inquiries="4" 
             data-urgent="0.0"
             data-category="구매확정관리"
             data-category-name="구매확정관리">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">구매확정관리</div>
    <div><span class="team-badge">재무</span></div>
    <div><span class="journey-badge">정산</span></div>
    <div class="metric-value">4건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="MD(사업부)" 
             data-journey="상품·콘텐츠" 
             data-inquiries="4" 
             data-urgent="0.0"
             data-category="상품문의(브리치)"
             data-category-name="상품문의(브리치)">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">상품문의(브리치)</div>
    <div><span class="team-badge">MD(사업부)</span></div>
    <div><span class="journey-badge">상품·콘텐츠</span></div>
    <div class="metric-value">4건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="CS" 
             data-journey="주문·배송" 
             data-inquiries="4" 
             data-urgent="0.0"
             data-category="주문조회"
             data-category-name="주문조회">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">주문조회</div>
    <div><span class="team-badge">CS</span></div>
    <div><span class="journey-badge">주문·배송</span></div>
    <div class="metric-value">4건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="재무" 
             data-journey="정산" 
             data-inquiries="4" 
             data-urgent="0.0"
             data-category="판매대행정산"
             data-category-name="판매대행정산">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">판매대행정산</div>
    <div><span class="team-badge">재무</span></div>
    <div><span class="journey-badge">정산</span></div>
    <div class="metric-value">4건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="재무" 
             data-journey="계정·입점" 
             data-inquiries="3" 
             data-urgent="0.0"
             data-category="사업자정보/양도양수"
             data-category-name="사업자정보/양도양수">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">사업자정보/양도양수</div>
    <div><span class="team-badge">재무</span></div>
    <div><span class="journey-badge">계정·입점</span></div>
    <div class="metric-value">3건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="영업" 
             data-journey="계정·입점" 
             data-inquiries="2" 
             data-urgent="0.0"
             data-category="신규회원가입"
             data-category-name="신규회원가입">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">신규회원가입</div>
    <div><span class="team-badge">영업</span></div>
    <div><span class="journey-badge">계정·입점</span></div>
    <div class="metric-value">2건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="정책" 
             data-journey="주문·배송" 
             data-inquiries="1" 
             data-urgent="0.0"
             data-category="배송정책 관리"
             data-category-name="배송정책 관리">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">배송정책 관리</div>
    <div><span class="team-badge">정책</span></div>
    <div><span class="journey-badge">주문·배송</span></div>
    <div class="metric-value">1건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="MD(사업부)" 
             data-journey="계정·입점" 
             data-inquiries="1" 
             data-urgent="0.0"
             data-category="브랜드권한신청"
             data-category-name="브랜드권한신청">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">브랜드권한신청</div>
    <div><span class="team-badge">MD(사업부)</span></div>
    <div><span class="journey-badge">계정·입점</span></div>
    <div class="metric-value">1건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="마케팅" 
             data-journey="상품·콘텐츠" 
             data-inquiries="1" 
             data-urgent="0.0"
             data-category="브리치 기획전신청"
             data-category-name="브리치 기획전신청">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">브리치 기획전신청</div>
    <div><span class="team-badge">마케팅</span></div>
    <div><span class="journey-badge">상품·콘텐츠</span></div>
    <div class="metric-value">1건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="개발" 
             data-journey="상품·콘텐츠" 
             data-inquiries="1" 
             data-urgent="0.0"
             data-category="상품등록 실패"
             data-category-name="상품등록 실패">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">상품등록 실패</div>
    <div><span class="team-badge">개발</span></div>
    <div><span class="journey-badge">상품·콘텐츠</span></div>
    <div class="metric-value">1건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="MD(사업부)" 
             data-journey="상품·콘텐츠" 
             data-inquiries="1" 
             data-urgent="0.0"
             data-category="상품문의(채널)"
             data-category-name="상품문의(채널)">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">상품문의(채널)</div>
    <div><span class="team-badge">MD(사업부)</span></div>
    <div><span class="journey-badge">상품·콘텐츠</span></div>
    <div class="metric-value">1건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="영업" 
             data-journey="계정·입점" 
             data-inquiries="1" 
             data-urgent="0.0"
             data-category="입점관리"
             data-category-name="입점관리">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">입점관리</div>
    <div><span class="team-badge">영업</span></div>
    <div><span class="journey-badge">계정·입점</span></div>
    <div class="metric-value">1건</div>
    <div class="urgent-rate low">0.0%</div>
</div><div class="category-table-row" 
             data-team="MD(사업부)" 
             data-journey="상품·콘텐츠" 
             data-inquiries="1" 
             data-urgent="0.0"
             data-category="채널딜 진행관리"
             data-category-name="채널딜 진행관리">
    <div class="category-name clickable-category" onclick="openCategoryModal(this)" title="클릭하여 상세 보기">채널딜 진행관리</div>
    <div><span class="team-badge">MD(사업부)</span></div>
    <div><span class="journey-badge">상품·콘텐츠</span></div>
    <div class="metric-value">1건</div>
    <div class="urgent-rate low">0.0%</div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
            <!-- 유저 여정 탭 -->
<div id="journey" class="tab-content">
    <div class="grid grid-5">
        <div class="entity-card">
    <div class="entity-card-header">
        <h3 class="entity-card-title">계정·입점</h3>
        <span class="entity-card-badge">43건</span>
    </div>
    <ul class="metrics-list">
        <li><span class="metric-name">총 문의</span><span class="metric-number">43</span></li>
        <li><span class="metric-name">긴급</span><span class="metric-number">1</span></li>
        <li><span class="metric-name">답변완료</span><span class="metric-number">42</span></li>
        <li><span class="metric-name">답변률</span><span class="metric-number">97.7%</span></li>
        <li><span class="metric-name">평균길이</span><span class="metric-number">89</span></li>
    </ul>
    {'플랜관리': 15, '스토어관리': 15, '탈퇴/재가입': 6, '사업자정보/양도양수': 3, '신규회원가입': 2}
</div><div class="entity-card">
    <div class="entity-card-header">
        <h3 class="entity-card-title">상품·콘텐츠</h3>
        <span class="entity-card-badge">97건</span>
    </div>
    <ul class="metrics-list">
        <li><span class="metric-name">총 문의</span><span class="metric-number">97</span></li>
        <li><span class="metric-name">긴급</span><span class="metric-number">1</span></li>
        <li><span class="metric-name">답변완료</span><span class="metric-number">94</span></li>
        <li><span class="metric-name">답변률</span><span class="metric-number">96.9%</span></li>
        <li><span class="metric-name">평균길이</span><span class="metric-number">84</span></li>
    </ul>
    {'상품 조회 및 수정': 41, '채널상품연동': 25, '상품등록': 23, '상품문의(브리치)': 4, '브리치 기획전신청': 1}
</div><div class="entity-card">
    <div class="entity-card-header">
        <h3 class="entity-card-title">주문·배송</h3>
        <span class="entity-card-badge">179건</span>
    </div>
    <ul class="metrics-list">
        <li><span class="metric-name">총 문의</span><span class="metric-number">179</span></li>
        <li><span class="metric-name">긴급</span><span class="metric-number">11</span></li>
        <li><span class="metric-name">답변완료</span><span class="metric-number">174</span></li>
        <li><span class="metric-name">답변률</span><span class="metric-number">97.2%</span></li>
        <li><span class="metric-name">평균길이</span><span class="metric-number">107</span></li>
    </ul>
    {'긴급문의': 81, '배송지연 관리 (결품취소)': 50, '발주/발송관리': 28, '배송현황관리': 8, '송장등록 실패/ 송장번호 수정': 7}
</div><div class="entity-card">
    <div class="entity-card-header">
        <h3 class="entity-card-title">반품·취소</h3>
        <span class="entity-card-badge">407건</span>
    </div>
    <ul class="metrics-list">
        <li><span class="metric-name">총 문의</span><span class="metric-number">407</span></li>
        <li><span class="metric-name">긴급</span><span class="metric-number">91</span></li>
        <li><span class="metric-name">답변완료</span><span class="metric-number">397</span></li>
        <li><span class="metric-name">답변률</span><span class="metric-number">97.5%</span></li>
        <li><span class="metric-name">평균길이</span><span class="metric-number">119</span></li>
    </ul>
    {'반품관리/환불보류': 216, '교환관리/교환철회': 147, '취소관리': 44}
</div><div class="entity-card">
    <div class="entity-card-header">
        <h3 class="entity-card-title">정산</h3>
        <span class="entity-card-badge">39건</span>
    </div>
    <ul class="metrics-list">
        <li><span class="metric-name">총 문의</span><span class="metric-number">39</span></li>
        <li><span class="metric-name">긴급</span><span class="metric-number">0</span></li>
        <li><span class="metric-name">답변완료</span><span class="metric-number">39</span></li>
        <li><span class="metric-name">답변률</span><span class="metric-number">100.0%</span></li>
        <li><span class="metric-name">평균길이</span><span class="metric-number">120</span></li>
    </ul>
    {'특약매입정산': 23, '정산통합': 8, '구매확정관리': 4, '판매대행정산': 4}
</div><div class="entity-card">
    <div class="entity-card-header">
        <h3 class="entity-card-title">기타</h3>
        <span class="entity-card-badge">120건</span>
    </div>
    <ul class="metrics-list">
        <li><span class="metric-name">총 문의</span><span class="metric-number">120</span></li>
        <li><span class="metric-name">긴급</span><span class="metric-number">2</span></li>
        <li><span class="metric-name">답변완료</span><span class="metric-number">120</span></li>
        <li><span class="metric-name">답변률</span><span class="metric-number">100.0%</span></li>
        <li><span class="metric-name">평균길이</span><span class="metric-number">144</span></li>
    </ul>
    {'기타': 120}
</div>
    </div>
</div>
            
            <!-- 개별 카테고리 모달들 -->
            
        
        </div>

        <div class="footer">
    <p>카테고리 기반 VoC 분석 보고서</p>
    <p>생성일시: 2025-06-11 17:32:13 | Pretendard 폰트 적용</p>
</div>
    </div>
    
            <script>
                
// ─────────── 팀별 아코디언 ───────────
function toggleTeamAccordion(teamId) {
    const content = document.getElementById(`content-${teamId}`);
    const item    = content.closest('.team-accordion-item');

    if (content.style.display === 'none' || !content.style.display) {
        openAccordion(content, item);
    } else {
        closeAccordion(content, item);
    }
}

// ─────────── 여정별 아코디언 ───────────
function toggleJourneyAccordion(journeyId) {
    const content = document.getElementById(`journey-content-${journeyId}`);
    const item    = content.closest('.journey-accordion-item');

    if (content.style.display === 'none' || !content.style.display) {
        openAccordion(content, item);
    } else {
        closeAccordion(content, item);
    }
}

// ─────────── 공통 열기/닫기 로직 ───────────
function openAccordion(content, item) {
    content.style.display   = 'block';
    content.style.height    = '0px';
    content.style.overflow  = 'hidden';
    content.style.transition= 'height 0.3s ease';
    item.classList.add('expanded');

    const h = content.scrollHeight;
    requestAnimationFrame(() => { content.style.height = h + 'px'; });

    setTimeout(() => {
        content.style.height = 'auto';
        content.style.overflow = 'visible';
    }, 300);
}

function closeAccordion(content, item) {
    content.style.height    = content.scrollHeight + 'px';
    content.style.overflow  = 'hidden';
    content.style.transition= 'height 0.3s ease';

    requestAnimationFrame(() => { content.style.height = '0px'; });

    setTimeout(() => {
        content.style.display   = 'none';
        content.style.height    = '';
        content.style.overflow  = '';
        content.style.transition= '';
        item.classList.remove('expanded');
    }, 300);
}

// ─────────── 전체 펼치기/접기 (개선된 버전) ───────────
function expandAllTeamAccordions() {
    console.log('팀별 전체 펼치기 실행');
    document.querySelectorAll('.team-accordion-item')
        .forEach(item => {
            const content = item.querySelector('.team-accordion-content');
            if (content && !item.classList.contains('expanded')) {
                const id = content.id.replace('content-','');
                console.log(`팀 펼치기: ${id}`);
                toggleTeamAccordion(id);
            }
        });
}

function collapseAllTeamAccordions() {
    console.log('팀별 전체 접기 실행');
    document.querySelectorAll('.team-accordion-item')
        .forEach(item => {
            const content = item.querySelector('.team-accordion-content');
            if (content && item.classList.contains('expanded')) {
                const id = content.id.replace('content-','');
                console.log(`팀 접기: ${id}`);
                toggleTeamAccordion(id);
            }
        });
}

function expandAllJourneyAccordions() {
    console.log('여정별 전체 펼치기 실행');
    document.querySelectorAll('.journey-accordion-item')
        .forEach(item => {
            const content = item.querySelector('.journey-accordion-content');
            if (content && !item.classList.contains('expanded')) {
                const id = content.id.replace('journey-content-','');
                console.log(`여정 펼치기: ${id}`);
                toggleJourneyAccordion(id);
            }
        });
}

function collapseAllJourneyAccordions() {
    console.log('여정별 전체 접기 실행');
    document.querySelectorAll('.journey-accordion-item')
        .forEach(item => {
            const content = item.querySelector('.journey-accordion-content');
            if (content && item.classList.contains('expanded')) {
                const id = content.id.replace('journey-content-','');
                console.log(`여정 접기: ${id}`);
                toggleJourneyAccordion(id);
            }
        });
}

// ─────────── 통합 전체 제어 (새로 추가) ───────────
function expandAllAccordions() {
    console.log('통합 전체 펼치기 실행');
    const activeView = document.querySelector('.analysis-view.active');
    if (!activeView) {
        console.log('활성 뷰를 찾을 수 없음');
        return;
    }
    
    const viewType = activeView.id.includes('teams') ? 'team' : 'journey';
    console.log(`현재 뷰 타입: ${viewType}`);
    
    if (viewType === 'team') {
        expandAllTeamAccordions();
    } else {
        expandAllJourneyAccordions();
    }
}

function collapseAllAccordions() {
    console.log('통합 전체 접기 실행');
    const activeView = document.querySelector('.analysis-view.active');
    if (!activeView) {
        console.log('활성 뷰를 찾을 수 없음');
        return;
    }
    
    const viewType = activeView.id.includes('teams') ? 'team' : 'journey';
    console.log(`현재 뷰 타입: ${viewType}`);
    
    if (viewType === 'team') {
        collapseAllTeamAccordions();
    } else {
        collapseAllJourneyAccordions();
    }
}


// ─────────── 필터 초기화 ───────────
function initCategoryFilters() {
    const seg = document.getElementById('segment-select');
    if (seg) seg.addEventListener('change', applyFilters);
    document.querySelectorAll('input[name="sort-type"]')
        .forEach(r => r.addEventListener('change', applyFilters));
}

// ─────────── 필터 적용 ───────────
function applyFilters() {
    const segVal  = document.getElementById('segment-select').value;
    const sortVal = document.querySelector('input[name="sort-type"]:checked').value;
    const cont    = document.getElementById('categories-container');
    if (!cont) return;

    const all  = Array.from(cont.children);
    let visible= [];

    // ① 세그먼트 필터
    if (segVal === 'all') {
        visible = all;
        updateSegmentInfo('전체 카테고리', all.length);
    } else if (segVal.startsWith('team-')) {
        const team = segVal.replace('team-','');
        visible = all.filter(c => c.dataset.team === team);
        updateSegmentInfo(`${team} 팀`, visible.length);
    } else if (segVal.startsWith('journey-')) {
        const jny = segVal.replace('journey-','');
        visible = all.filter(c => c.dataset.journey === jny);
        updateSegmentInfo(`${jny} 여정`, visible.length);
    }

    // ② 정렬
    visible.sort((a,b) => applySortLogic(a,b,sortVal));

    // ③ DOM 반영
    all.forEach(c => { c.style.display = visible.includes(c) ? 'block':'none'; });
    visible.forEach(c => cont.appendChild(c));

    updateFilterFeedback(segVal, sortVal, visible.length);
}

function applySortLogic(a,b,type){
    switch(type){
        case 'volume': return (b.dataset.count|0) - (a.dataset.count|0);
        case 'urgent': return parseFloat(b.dataset.urgentRate||0) - parseFloat(a.dataset.urgentRate||0);
        case 'answer': return parseFloat(a.dataset.answerRate||0) - parseFloat(b.dataset.answerRate||0);
        default:       return 0;
    }
}

// ─────────── 보조 UI 업데이트 ───────────
function updateSegmentInfo(segText, count){
    const t = document.getElementById('current-segment-text');
    const n = document.getElementById('visible-count');
    if (t) t.textContent = segText;
    if (n) n.textContent = count;
}

function updateFilterFeedback(segVal, sortVal, count){
    const box=document.getElementById('categories-container');
    if(!box) return;

    box.classList.remove('filter-all','filter-team','filter-journey',
                         'filter-volume','filter-urgent','filter-answer');

    if(segVal==='all')          box.classList.add('filter-all');
    else if(segVal.startsWith('team-'))    box.classList.add('filter-team');
    else if(segVal.startsWith('journey-')) box.classList.add('filter-journey');

    box.classList.add(`filter-${sortVal}`);
    console.log(`필터 피드백: ${segVal} + ${sortVal} → ${count}개`);
}

// ─────────── 드롭다운 옵션 동적 생성 ───────────
function populateTeamOptions() {
    const sel = document.getElementById('segment-select');
    const cont= document.getElementById('categories-container');
    if (!sel || !cont) return;

    const optgrp = sel.querySelector('optgroup[label="팀별"]');
    optgrp.querySelectorAll('option').forEach(o=>o.remove());

    const teams = new Set([...cont.children].map(c=>c.dataset.team).filter(t=>t && t!=='기타'));
    [...teams].sort().forEach(t=>{
        const o=document.createElement('option');
        o.value=`team-${t}`; o.textContent=t; optgrp.appendChild(o);
    });
}


function openModal(id){
    const m=document.getElementById(id);
    if(m){ m.classList.add('active'); document.body.style.overflow='hidden'; }
}
function closeModal(id){
    const m=document.getElementById(id);
    if(m){ m.classList.remove('active'); document.body.style.overflow='auto'; }
}

// ESC
document.addEventListener('keydown',e=>{
    if(e.key==='Escape'){
        const act=document.querySelector('.modal-overlay.active');
        if(act) closeModal(act.id);
    }
});
// 외부 클릭
document.addEventListener('click',e=>{
    if(e.target.classList.contains('modal-overlay')) closeModal(e.target.id);
});


function switchTab(name){
    document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    document.getElementById(name).classList.add('active');
    event.target.classList.add('active');
}

function toggleAnalysisView(){
    const view=document.querySelector('input[name="analysis-view"]:checked').value;
    
    // 모든 분석 뷰 숨기기
    document.querySelectorAll('.analysis-view').forEach(v=>{
        v.style.display='none'; 
        v.classList.remove('active');
    });
    
    // 컨트롤 버튼 전환
    const accordionControls = document.querySelector('.accordion-controls');
    const tableControls = document.querySelector('.table-controls');
    
    if (view === 'categories') {
        // 카테고리 테이블 뷰 활성화
        const target = document.getElementById('categories-table-view');
        if (target) {
            target.style.display = 'block';
            target.classList.add('active');
        }
        
        // 컨트롤 전환
        if (accordionControls) accordionControls.classList.add('hidden');
        if (tableControls) tableControls.classList.add('active');
        
        // 테이블 초기화
        setTimeout(() => {
            if (typeof initCategoryTable === 'function') {
                initCategoryTable();
            }
        }, 100);
        
    } else {
        // 아코디언 뷰 활성화 (teams 또는 journey)
        const target = document.getElementById(`${view}-accordion-view`);
        if (target) {
            target.style.display = 'block';
            target.classList.add('active');
        }
        
        // 컨트롤 전환
        if (accordionControls) accordionControls.classList.remove('hidden');
        if (tableControls) tableControls.classList.remove('active');
    }
    
    console.log(`분석 뷰 전환: ${view}`);
}


// ═══════════════════════════════════════════════════════════
// 카테고리 테이블 필터링 및 정렬 스크립트 - 새 모달 + 드롭다운
// ═══════════════════════════════════════════════════════════

let tableFilters = {
    category: '',
    team: '',
    journey: '',
    sort: '',
    sortOrder: ''
};

// ─────────── 새 모달 시스템 ───────────
function openCategoryModal(element) {
    const row = element.closest('.category-table-row');
    const categoryName = row.dataset.categoryName;
    const team = row.dataset.team;
    const journey = row.dataset.journey;
    const inquiries = row.dataset.inquiries;
    const urgentRate = row.dataset.urgent;
    
    console.log(`카테고리 모달 열기: ${categoryName}`);
    
    // 모달 HTML 생성
    const modalContent = `
        <div style="margin-bottom: 20px; padding: 16px; background: linear-gradient(135deg, #f8fafc, #e2e8f0); border-radius: 8px;">
            <h4 style="margin: 0 0 12px 0; color: #374151;">📊 ${categoryName} 상세 정보</h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                <div style="text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: bold; color: #667eea;">${inquiries}</div>
                    <div style="font-size: 0.85rem; color: #6b7280;">총 문의</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: bold; color: #ef4444;">${urgentRate}%</div>
                    <div style="font-size: 0.85rem; color: #6b7280;">긴급률</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 1rem; font-weight: bold; color: #f59e0b;">${team}</div>
                    <div style="font-size: 0.85rem; color: #6b7280;">담당팀</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 1rem; font-weight: bold; color: #10b981;">${journey}</div>
                    <div style="font-size: 0.85rem; color: #6b7280;">유저여정</div>
                </div>
            </div>
        </div>
        
        <div style="background: #f8fafc; padding: 16px; border-radius: 8px;">
            <h5 style="margin: 0 0 12px 0; color: #374151;">📝 문의 샘플</h5>
            <div style="background: white; padding: 12px; border-radius: 6px; border-left: 4px solid #667eea;">
                <div style="font-size: 0.9rem; color: #6b7280; margin-bottom: 8px;">
                    <strong>샘플 문의 내용:</strong>
                </div>
                <div style="color: #374151; line-height: 1.5;">
                    이 카테고리에 해당하는 실제 고객 문의 내용이 여기에 표시됩니다. 
                    현재는 샘플 데이터로 표시되고 있으며, 실제 구현 시에는 해당 카테고리의 
                    대표적인 문의 사례들이 표시될 예정입니다.
                </div>
                <div style="margin-top: 8px; font-size: 0.8rem; color: #9ca3af;">
                    등록일: 2024-01-15 | 상태: 답변완료
                </div>
            </div>
            <div style="background: white; padding: 12px; border-radius: 6px; border-left: 4px solid #f59e0b; margin-top: 8px;">
                <div style="font-size: 0.9rem; color: #6b7280; margin-bottom: 8px;">
                    <strong>긴급 문의 샘플:</strong>
                </div>
                <div style="color: #374151; line-height: 1.5;">
                    긴급하게 처리가 필요한 문의 사례입니다. 
                    이런 유형의 문의들이 전체 문의 중 ${urgentRate}%를 차지하고 있습니다.
                </div>
                <div style="margin-top: 8px; font-size: 0.8rem; color: #ef4444;">
                    등록일: 2024-01-16 | 상태: 처리중 | 🚨 긴급
                </div>
            </div>
        </div>
    `;
    
    createNewModal(`category-modal-${categoryName.replace(/[^a-zA-Z0-9]/g, '')}`, 
                   `📂 ${categoryName} 상세 보기`, 
                   modalContent);
}

function createNewModal(modalId, title, content) {
    // 기존 모달이 있다면 제거
    const existingModal = document.getElementById(modalId);
    if (existingModal) {
        existingModal.remove();
    }
    
    // 새 모달 생성
    const modal = document.createElement('div');
    modal.id = modalId;
    modal.className = 'new-modal-overlay';
    modal.innerHTML = `
        <div class="new-modal-content">
            <div class="new-modal-header">
                <h3 class="new-modal-title">${title}</h3>
                <button class="new-modal-close" onclick="closeNewModal('${modalId}')">&times;</button>
            </div>
            <div class="new-modal-body">
                ${content}
            </div>
        </div>
    `;
    
    // body에 추가
    document.body.appendChild(modal);
    
    // 모달 표시
    setTimeout(() => {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }, 10);
}

function closeNewModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.remove('active');
        document.body.style.overflow = 'auto';
        setTimeout(() => {
            modal.remove();
        }, 300);
    }
}

// ─────────── 오른쪽 아래 드롭다운 토글 함수들 ───────────
function toggleSearchFilter() {
    const btn = event.target.closest('.filter-icon-btn');
    const dropdown = document.getElementById('search-dropdown');
    const input = document.getElementById('category-search-input');
    
    // 다른 활성 드롭다운들 닫기
    closeOtherDropdowns('search');
    
    if (dropdown.classList.contains('hidden')) {
        dropdown.classList.remove('hidden');
        input.focus();
        btn.classList.add('active');
    } else {
        dropdown.classList.add('hidden');
        btn.classList.remove('active');
        // 드롭다운을 닫을 때만 필터 초기화 (X 버튼 클릭이나 외부 클릭)
        if (input.value) {
            input.value = '';
            filterByCategory('');
        }
    }
}

function toggleTeamFilter() {
    const btn = event.target.closest('.filter-icon-btn');
    const dropdown = document.getElementById('team-dropdown');
    
    // 다른 활성 드롭다운들 닫기
    closeOtherDropdowns('team');
    
    if (dropdown.classList.contains('hidden')) {
        dropdown.classList.remove('hidden');
        btn.classList.add('active');
    } else {
        dropdown.classList.add('hidden');
        btn.classList.remove('active');
        // 드롭다운을 닫을 때만 필터 초기화 (X 버튼 클릭이나 외부 클릭)
        const select = document.getElementById('team-filter-dropdown');
        if (select.value) {
            select.selectedIndex = 0;
            filterByTeam('');
        }
    }
}

function toggleJourneyFilter() {
    const btn = event.target.closest('.filter-icon-btn');
    const dropdown = document.getElementById('journey-dropdown');
    
    // 다른 활성 드롭다운들 닫기
    closeOtherDropdowns('journey');
    
    if (dropdown.classList.contains('hidden')) {
        dropdown.classList.remove('hidden');
        btn.classList.add('active');
    } else {
        dropdown.classList.add('hidden');
        btn.classList.remove('active');
        // 드롭다운을 닫을 때만 필터 초기화 (X 버튼 클릭이나 외부 클릭)
        const select = document.getElementById('journey-filter-dropdown');
        if (select.value) {
            select.selectedIndex = 0;
            filterByJourney('');
        }
    }
}

function closeOtherDropdowns(except) {
    const dropdowns = [
        { id: 'search-dropdown', btn: '[onclick="toggleSearchFilter()"]', reset: () => {
            document.getElementById('category-search-input').value = '';
            filterByCategory('');
        }},
        { id: 'team-dropdown', btn: '[onclick="toggleTeamFilter()"]', reset: () => {
            document.getElementById('team-filter-dropdown').selectedIndex = 0;
            filterByTeam('');
        }},
        { id: 'journey-dropdown', btn: '[onclick="toggleJourneyFilter()"]', reset: () => {
            document.getElementById('journey-filter-dropdown').selectedIndex = 0;
            filterByJourney('');
        }}
    ];
    
    dropdowns.forEach(item => {
        const dropdownType = item.id.split('-')[0];
        if (dropdownType !== except) {
            const dropdown = document.getElementById(item.id);
            const btn = document.querySelector(item.btn);
            if (dropdown && !dropdown.classList.contains('hidden')) {
                dropdown.classList.add('hidden');
                if (btn) btn.classList.remove('active');
                item.reset();
            }
        }
    });
}

// ─────────── 필터링 함수들 ───────────
function filterByCategory(value) {
    tableFilters.category = value.toLowerCase();
    applyTableFilters();
    
    // 필터 선택 즉시 드롭다운 닫기
    if (value) {
        const dropdown = document.getElementById('search-dropdown');
        const btn = document.querySelector('[onclick="toggleSearchFilter()"]');
        if (dropdown) dropdown.classList.add('hidden');
        if (btn) btn.classList.remove('active');
    }
}

function filterByTeam(value) {
    tableFilters.team = value;
    applyTableFilters();
    
    // 필터 선택 즉시 드롭다운 닫기
    const dropdown = document.getElementById('team-dropdown');
    const btn = document.querySelector('[onclick="toggleTeamFilter()"]');
    if (dropdown) dropdown.classList.add('hidden');
    if (btn) btn.classList.remove('active');
}

function filterByJourney(value) {
    tableFilters.journey = value;
    applyTableFilters();
    
    // 필터 선택 즉시 드롭다운 닫기
    const dropdown = document.getElementById('journey-dropdown');
    const btn = document.querySelector('[onclick="toggleJourneyFilter()"]');
    if (dropdown) dropdown.classList.add('hidden');
    if (btn) btn.classList.remove('active');
}

// ─────────── 정렬 함수들 ───────────
function sortByInquiries() {
    const btn = document.getElementById('inquiries-sort');
    if (tableFilters.sort === 'inquiries') {
        tableFilters.sortOrder = tableFilters.sortOrder === 'asc' ? 'desc' : 'asc';
    } else {
        tableFilters.sort = 'inquiries';
        tableFilters.sortOrder = 'desc';
    }
    
    updateSortButtons(btn);
    applyTableFilters();
}

function sortByUrgent() {
    const btn = document.getElementById('urgent-sort');
    if (tableFilters.sort === 'urgent') {
        tableFilters.sortOrder = tableFilters.sortOrder === 'asc' ? 'desc' : 'asc';
    } else {
        tableFilters.sort = 'urgent';
        tableFilters.sortOrder = 'desc';
    }
    
    updateSortButtons(btn);
    applyTableFilters();
}

function updateSortButtons(activeBtn) {
    // 모든 정렬 버튼 초기화
    document.querySelectorAll('.sort-icon-btn').forEach(btn => {
        btn.classList.remove('active', 'asc', 'desc');
    });
    
    // 활성 버튼 스타일 적용
    activeBtn.classList.add('active', tableFilters.sortOrder);
}

// ─────────── 필터 적용 메인 함수 ───────────
function applyTableFilters() {
    const rows = Array.from(document.querySelectorAll('.category-table-row'));
    let visibleCount = 0;

    // 필터링
    rows.forEach(row => {
        let show = true;

        // 카테고리명 검색
        if (tableFilters.category) {
            const categoryName = row.dataset.category || '';
            if (!categoryName.includes(tableFilters.category)) {
                show = false;
            }
        }

        // 팀 필터
        if (tableFilters.team) {
            const team = row.dataset.team;
            if (team !== tableFilters.team) {
                show = false;
            }
        }

        // 여정 필터
        if (tableFilters.journey) {
            const journey = row.dataset.journey;
            if (journey !== tableFilters.journey) {
                show = false;
            }
        }

        if (show) {
            row.classList.remove('hidden');
            visibleCount++;
        } else {
            row.classList.add('hidden');
        }
    });

    // 정렬
    if (tableFilters.sort) {
        sortTableRows(rows);
    }

    updateTableFilterStatus(visibleCount, rows.length);
}

// ─────────── 정렬 실행 ───────────
function sortTableRows(rows) {
    const visibleRows = rows.filter(row => !row.classList.contains('hidden'));
    const container = document.querySelector('.category-table-body');

    visibleRows.sort((a, b) => {
        let aVal, bVal;
        
        if (tableFilters.sort === 'inquiries') {
            aVal = parseInt(a.dataset.inquiries || '0');
            bVal = parseInt(b.dataset.inquiries || '0');
        } else if (tableFilters.sort === 'urgent') {
            aVal = parseFloat(a.dataset.urgent || '0');
            bVal = parseFloat(b.dataset.urgent || '0');
        }

        if (tableFilters.sortOrder === 'asc') {
            return aVal - bVal;
        } else {
            return bVal - aVal;
        }
    });

    // DOM 재배치
    visibleRows.forEach(row => container.appendChild(row));
}

// ─────────── 상태 업데이트 ───────────
function updateTableFilterStatus(visible, total) {
    const statusElement = document.getElementById('table-filter-status');
    const countElement = document.getElementById('visible-categories-count');
    const clearBtn = document.querySelector('.clear-table-filters');
    
    if (countElement) {
        countElement.textContent = visible;
    }
    
    let statusText = '';
    let filterDescription = '';
    
    // 적용된 필터들 수집
    const activeFilters = [];
    if (tableFilters.category) {
        activeFilters.push(`검색: "${tableFilters.category}"`);
    }
    if (tableFilters.team) {
        activeFilters.push(`팀: ${tableFilters.team}`);
    }
    if (tableFilters.journey) {
        activeFilters.push(`여정: ${tableFilters.journey}`);
    }
    
    if (activeFilters.length > 0) {
        filterDescription = activeFilters.join(' | ');
        statusText = `📂 <strong>필터 적용</strong>: ${filterDescription} (${total}개 중 ${visible}개 표시)`;
        if (clearBtn) clearBtn.style.display = 'inline';
    } else {
        statusText = `📂 <strong>전체 카테고리</strong> 표시 중 (${visible}개)`;
        if (clearBtn) clearBtn.style.display = 'none';
    }
    
    if (statusElement) {
        statusElement.innerHTML = statusText + (clearBtn && clearBtn.style.display === 'inline' ? clearBtn.outerHTML : '');
    }
}

// ─────────── 필터 초기화 ───────────
function clearAllTableFilters() {
    tableFilters = { category: '', team: '', journey: '', sort: '', sortOrder: '' };
    
    // 모든 입력 초기화
    const categoryInput = document.getElementById('category-search-input');
    if (categoryInput) {
        categoryInput.value = '';
    }
    
    document.querySelectorAll('.dropdown-filter-select').forEach(select => {
        select.selectedIndex = 0;
    });
    
    document.querySelectorAll('.dropdown-menu').forEach(dropdown => {
        dropdown.classList.add('hidden');
    });
    
    document.querySelectorAll('.filter-icon-btn, .sort-icon-btn').forEach(btn => {
        btn.classList.remove('active', 'asc', 'desc');
    });
    
    applyTableFilters();
}

function resetTableFilters() {
    clearAllTableFilters();
}

// ─────────── 기타 테이블 기능 ───────────
function exportTableData() {
    console.log('테이블 데이터 내보내기 실행');
    const visibleRows = document.querySelectorAll('.category-table-row:not(.hidden)');
    console.log(`내보낼 데이터: ${visibleRows.length}개 카테고리`);
    alert('필터된 카테고리 데이터를 CSV로 내보냅니다.');
}

// ─────────── 외부 클릭으로 드롭다운 닫기 ───────────
document.addEventListener('click', function(event) {
    // 드롭다운 관련 요소가 아닌 곳을 클릭했을 때 모든 드롭다운 닫기
    if (!event.target.closest('.filter-dropdown-wrapper')) {
        closeOtherDropdowns('none');
    }
});

// ─────────── ESC 키로 모달 닫기 ───────────
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        const activeModal = document.querySelector('.new-modal-overlay.active');
        if (activeModal) {
            closeNewModal(activeModal.id);
        }
    }
});

// ─────────── 초기화 ───────────
function initCategoryTable() {
    console.log('카테고리 테이블 초기화');
    
    // 초기 필터 상태 설정
    const allRows = document.querySelectorAll('.category-table-row');
    updateTableFilterStatus(allRows.length, allRows.length);
    
    // 초기 정렬 (문의량 내림차순)
    if (allRows.length > 0) {
        tableFilters.sort = 'inquiries';
        tableFilters.sortOrder = 'desc';
        
        const inquiriesBtn = document.getElementById('inquiries-sort');
        if (inquiriesBtn) {
            updateSortButtons(inquiriesBtn);
            sortTableRows(Array.from(allRows));
        }
    }
}


document.addEventListener('DOMContentLoaded',()=>{
    console.log('VoC 리포터 로드 완료');

    // 첫 탭 활성화
    const firstTab=document.querySelector('.tab-content');
    const firstBtn=document.querySelector('.tab-btn');
    if(firstTab&&firstBtn){ firstTab.classList.add('active'); firstBtn.classList.add('active'); }

    // 카테고리 필터
    if(document.getElementById('categories')){
        setTimeout(()=>{ populateTeamOptions(); initCategoryFilters(); applyFilters(); },100);
    }

    // 개선된 분석 뷰 토글 & 컨트롤
    if(document.querySelector('.detailed-analysis-section')){
        console.log('개선된 상세 분석 섹션 초기화');
        
        // 분석 뷰 토글 이벤트 리스너 추가
        document.querySelectorAll('input[name="analysis-view"]')
            .forEach(r=>r.addEventListener('change', toggleAnalysisView));
        
        // 기존 제어 버튼들 제거 (이제 통합 컨트롤 바에 있음)
        // 더 이상 개별 버튼을 동적으로 추가하지 않음
        console.log('통합 컨트롤 바 사용으로 개별 버튼 생성 생략');
    }
    
    // 레거시 분석 토글 섹션 지원 (하위 호환성)
    else if(document.querySelector('.analysis-toggle-section')){
        console.log('레거시 분석 토글 섹션 초기화');
        
        document.querySelectorAll('input[name="analysis-view"]')
            .forEach(r=>r.addEventListener('change', toggleAnalysisView));

        // 레거시 제어 버튼 삽입
        ['teams','journey'].forEach(type=>{
            const v=document.getElementById(`${type}-accordion-view`);
            if(!v) return;
            const wrap=document.createElement('div');
            wrap.className=`accordion-controls ${type}-controls`;
            wrap.style.cssText='margin-bottom:16px;text-align:right;gap:8px;display:flex;justify-content:flex-end;';
            wrap.innerHTML = type==='teams'
                ? `<button onclick="expandAllTeamAccordions()">팀별 전체 펼치기</button>
                   <button onclick="collapseAllTeamAccordions()">팀별 전체 접기</button>`
                : `<button onclick="expandAllJourneyAccordions()">여정별 전체 펼치기</button>
                   <button onclick="collapseAllJourneyAccordions()">여정별 전체 접기</button>`;
            v.insertBefore(wrap, v.firstChild);
        });
    }
});

                
                function switchTab(tabName) {
                    // 모든 탭 컨텐츠 숨기기
                    document.querySelectorAll('.tab-content').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    
                    // 모든 탭 버튼 비활성화
                    document.querySelectorAll('.tab-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // 선택된 탭 활성화
                    document.getElementById(tabName).classList.add('active');
                    event.target.classList.add('active');
                }
            </script>
            
</body>
</html>